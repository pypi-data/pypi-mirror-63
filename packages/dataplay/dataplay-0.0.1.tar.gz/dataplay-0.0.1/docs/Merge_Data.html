---

title: Merge Data

keywords: fastai
sidebar: home_sidebar

summary: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
description: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/02_Merge_Data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This Coding Notebook is the <strong>second</strong> in a series.</p>
<p>An Interactive version can be found here <a href="https://colab.research.google.com/github/BNIA/colabs/blob/master/02_Merge_Data.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>.</p>
<p>This colab and more can be found at <a href="https://github.com/BNIA/colabs">https://github.com/BNIA/colabs</a></p>
<ul>
<li><p>Content covered in previous tutorials will be used in later tutorials.</p>
</li>
<li><p><strong>new code and or  information <em>should</em> have explanations and or descriptions</strong> attached.</p>
</li>
<li><p>Concepts or code covered in previous tutorials will be used without being explaining in entirety.</p>
</li>
<li><p><strong>If content can not be found in the current tutorial and is not covered in previous tutorials, please let me know.</strong></p>
</li>
<li><p>This notebook has been optimized for Google Colabs ran on a Chrome Browser.</p>
</li>
<li><p>statements made in light of view expressed, responsibility, errors and ommissions, use at risk, and licensing from part one of this tutorial extend throughout.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About-this-Tutorial:">About this Tutorial:<a class="anchor-link" href="#About-this-Tutorial:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Whats-Inside?">Whats Inside?<a class="anchor-link" href="#Whats-Inside?"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-Tutorial"><strong>The Tutorial</strong><a class="anchor-link" href="#The-Tutorial"> </a></h4><p>In this notebook, the basics of how to perform a merge is introduced</p>
<ul>
<li>We will merge two datasets</li>
<li>We will merge two datasets using a crosswalk</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Objectives"><strong>Objectives</strong><a class="anchor-link" href="#Objectives"> </a></h4><p>By the end of this tutorial users should have an understanding of:</p>
<ul>
<li>How dataset merges are performed</li>
<li>The types different union approaches a merge can take</li>
<li>the 'mergeData' function, and how to use it in the future</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Guided-Walkthrough">Guided Walkthrough<a class="anchor-link" href="#Guided-Walkthrough"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SETUP">SETUP<a class="anchor-link" href="#SETUP"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@title Import Modules</span>

<span class="o">%%</span><span class="k">capture</span> 

# These imports will handle everything
import os
import sys
import csv
import numpy as np
import pandas as pd
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Configure-Enviornment">Configure Enviornment<a class="anchor-link" href="#Configure-Enviornment"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This will just beautify the output</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_colwidth&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.expand_frame_repr&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="(Optional)-Local-File-Access">(Optional) Local File Access<a class="anchor-link" href="#(Optional)-Local-File-Access"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># (Optional) Run this cell to gain access to Google Drive (Colabs only) </span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>

<span class="c1"># Colabs operates in a virtualized enviornment</span>
<span class="c1"># Colabs default directory is at ~/content.</span>
<span class="c1"># We mount Drive into a temporary folder at &#39;~/content/drive&#39; </span>

<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Once connected, I navigate to where the data lives in my drive folder.</span>

<span class="o">!</span><span class="nb">cd</span> ../../../drive/<span class="s1">&#39;My Drive&#39;</span>/colabs/DATA
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Retrieve-Datasets">Retrieve Datasets<a class="anchor-link" href="#Retrieve-Datasets"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our example will merge two simple datasets; pulling CSA names using tract ID's.</p>
<p>The First dataset will be obtained from the Census' ACS 5-year serveys.</p>
<p>Functions used to obtain this data were obtained from Tutorial 0) ACS: Explore and Download.</p>
<p>The Second dataset will be obtained using using a CSV from a publicly accessible link</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Principal-dataset.">Get the Principal dataset.<a class="anchor-link" href="#Get-the-Principal-dataset."> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following two scripts will load required code and create the required functions to download ACS data.</p>
<p>More information on this section can be found in the previous tutorial denoted above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@title Run This Cell: Import Modules</span>

<span class="o">%%</span><span class="k">capture</span> 
# ^ will hide unruly the output so as not to confuse users

# Install the Widgets Module. 
# Colabs does not locally provide this Python Library
# The &#39;!&#39; is a special prefix used in colabs when talking to the terminal
!pip install -U -q ipywidgets
!pip install geopandas

# Once installed we need to import and configure the Widgets
import ipywidgets as widgets
!jupyter nbextension enable --py widgetsnbextension
from IPython.core.interactiveshell import InteractiveShell
InteractiveShell.ast_node_interactivity = &#39;all&#39;
import ipywidgets as widgets
from ipywidgets import interact, interact_manual

# Used 4 Importing Data
import urllib.request as urllib 
from urllib.parse import urlencode 
# This Prevents Timeouts when Importing
import socket 
socket.setdefaulttimeout(10.0)

# Pandas Data Manipulation Libraries
import pandas as pd
# Show entire column widths
pd.set_option(&#39;display.max_colwidth&#39;, -1)
# 4 Working with Json Data
import json 
# 4 Data Processing
import numpy as np
# 4 Reading Json Data into Pandas
from pandas.io.json import json_normalize

# 4 exporting data as CSV
import csv


# Geo-Formatting
# Postgres-Conversion
import geopandas as gpd
from geopandas import GeoDataFrame
import psycopg2,pandas,numpy
from shapely import wkb
from shapely.wkt import loads
import os
import sys

# In case file is KML
import fiona
fiona.drvsupport.supported_drivers[&#39;kml&#39;] = &#39;rw&#39; # enable KML support which is disabled by default
fiona.drvsupport.supported_drivers[&#39;KML&#39;] = &#39;rw&#39; # enable KML support which is disabled by default

# https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2010.html
# https://www.census.gov/cgi-bin/geo/shapefiles/index.php?year=2010&amp;layergroup=Census+Tracts

# load libraries
#from shapely.wkt import loads
#from pandas import ExcelWriter
#from pandas import ExcelFile
%matplotlib inline
import matplotlib.pyplot as plt
import glob
import imageio
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># @title Run: Create retrieve_acs_data()</span>

<span class="c1">#File: retrieveAcsData.py</span>
<span class="c1">#Author: Charles Karpati</span>
<span class="c1">#Date: 1/9/19</span>
<span class="c1">#Section: Bnia</span>
<span class="c1">#Email: karpati1@umbc.edu</span>
<span class="c1">#Description:</span>
<span class="c1">#This file returns ACS data given an ID and Year</span>
<span class="c1"># The county total is given a tract of &#39;010000&#39;</span>

<span class="c1">#def retrieve_acs_data():</span>
<span class="c1">#purpose: Retrieves ACS data from the web</span>
<span class="c1">#input: </span>
<span class="c1"># state (required) </span>
<span class="c1"># county (required) </span>
<span class="c1"># tract (required) </span>
<span class="c1"># tableId (required)</span>
<span class="c1"># year (required)</span>
<span class="c1"># includeCountyAgg (required)(todo) </span>
<span class="c1"># saveAcs (required) </span>
<span class="c1">#output: </span>
<span class="c1"># Acs Data. </span>
<span class="c1"># Prints to ../../data/2_cleaned/acs/</span>

<span class="n">dictionary</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">def</span> <span class="nf">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">):</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">keys1</span><span class="o">=</span><span class="n">keys2</span><span class="o">=</span><span class="n">keys3</span><span class="o">=</span><span class="n">keys4</span><span class="o">=</span><span class="n">keys5</span><span class="o">=</span><span class="n">keys6</span><span class="o">=</span><span class="n">keys7</span><span class="o">=</span><span class="n">keys8</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">keyCount</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Called in addKeys(), Will create the final URL for readIn()</span>
    <span class="c1"># These are parameters used in the API URL Query</span>
    <span class="c1"># This query will retrieve the census tracts</span>
    <span class="k">def</span> <span class="nf">getParams</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span> <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;NAME&#39;</span><span class="o">+</span><span class="n">keys</span><span class="p">,</span>
        <span class="s1">&#39;for&#39;</span><span class="p">:</span> <span class="s1">&#39;tract:&#39;</span><span class="o">+</span><span class="n">tract</span><span class="p">,</span>
        <span class="s1">&#39;in&#39;</span><span class="p">:</span> <span class="s1">&#39;state:&#39;</span><span class="o">+</span><span class="n">state</span><span class="o">+</span><span class="s1">&#39; county:&#39;</span><span class="o">+</span><span class="n">county</span><span class="p">,</span>
        <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;829bf6f2e037372acbba32ba5731647c5127fdb0&#39;</span>
      <span class="p">}</span>
    <span class="c1"># Aggregate City data is best retrieved seperatly rather than as an aggregate of its constituent tracts</span>
    <span class="k">def</span> <span class="nf">getCityParams</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span> <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;NAME&#39;</span><span class="o">+</span><span class="n">keys</span><span class="p">,</span>
        <span class="s1">&#39;for&#39;</span><span class="p">:</span> <span class="s1">&#39;county:&#39;</span><span class="o">+</span><span class="n">county</span><span class="p">,</span>
        <span class="s1">&#39;in&#39;</span><span class="p">:</span> <span class="s1">&#39;state:&#39;</span><span class="o">+</span><span class="n">state</span><span class="p">,</span>
        <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;829bf6f2e037372acbba32ba5731647c5127fdb0&#39;</span>
      <span class="p">}</span>
    <span class="c1"># Called in AddKeys(). Requests data by url and preformats it.</span>
    <span class="k">def</span> <span class="nf">readIn</span><span class="p">(</span> <span class="n">url</span> <span class="p">):</span>
        <span class="n">tbl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
        <span class="n">tbl</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">tbl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">tbl</span> 

    <span class="c1"># Called by retrieveAcsData. </span>
    <span class="c1"># Creates a url and retrieve the data</span>
    <span class="c1"># Then appends the city values as tract &#39;010000&#39;</span>
    <span class="c1"># Finaly it merges and returns the tract and city totals.</span>
    <span class="k">def</span> <span class="nf">addKeys</span><span class="p">(</span> <span class="n">table</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="c1"># Get Tract and City Records For Specific Columns</span>
        <span class="n">table2</span> <span class="o">=</span> <span class="n">readIn</span><span class="p">(</span> <span class="n">base</span><span class="o">+</span><span class="n">urlencode</span><span class="p">(</span><span class="n">getParams</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">table3</span> <span class="o">=</span> <span class="n">readIn</span><span class="p">(</span> <span class="n">base</span><span class="o">+</span><span class="n">urlencode</span><span class="p">(</span><span class="n">getCityParams</span><span class="p">(</span><span class="n">params</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">table3</span><span class="p">[</span><span class="s1">&#39;tract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;010000&#39;</span>
        <span class="c1"># Concatenate the Records</span>
        <span class="n">table2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">table2</span><span class="p">,</span> <span class="n">table3</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">table2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">table2</span><span class="p">,</span> <span class="n">table3</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Merge to Master Table</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">table2</span><span class="p">,</span>  <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> 
                         <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span><span class="s2">&quot;state&quot;</span><span class="p">,</span><span class="s2">&quot;county&quot;</span><span class="p">,</span><span class="s2">&quot;tract&quot;</span><span class="p">],</span> 
                         <span class="n">right_on</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span><span class="s2">&quot;state&quot;</span><span class="p">,</span><span class="s2">&quot;county&quot;</span><span class="p">,</span><span class="s2">&quot;tract&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">table</span>
    
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 1)</span>
    <span class="c1"># Retrieve a Meta Data Table Describing the Content of the Table</span>
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.census.gov/data/20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;/acs/acs5/groups/&#39;</span><span class="o">+</span><span class="n">tableId</span><span class="o">+</span><span class="s1">&#39;.json&#39;</span>
    <span class="n">metaDataTable</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
    
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 2)</span>
    <span class="c1"># Createa a Dictionary using the Meta Data Table</span>
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Multiple Queries may be Required.</span>
    <span class="c1"># Max columns returned from any given query is 50.</span>
    <span class="c1"># For that reasons bin the Columns into Groups of 50.</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metaDataTable</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="n">keyCount</span> <span class="o">=</span> <span class="n">keyCount</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="p">:</span> <span class="n">keys1</span> <span class="o">=</span> <span class="n">keys1</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="k">elif</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">80</span> <span class="p">:</span> <span class="n">keys2</span> <span class="o">=</span> <span class="n">keys2</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="k">elif</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">120</span> <span class="p">:</span> <span class="n">keys3</span> <span class="o">=</span> <span class="n">keys3</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="k">elif</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">160</span> <span class="p">:</span> <span class="n">keys4</span> <span class="o">=</span> <span class="n">keys4</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="k">elif</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">200</span> <span class="p">:</span> <span class="n">keys5</span> <span class="o">=</span> <span class="n">keys5</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="k">elif</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">240</span> <span class="p">:</span> <span class="n">keys6</span> <span class="o">=</span> <span class="n">keys6</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="k">elif</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">280</span> <span class="p">:</span> <span class="n">keys7</span> <span class="o">=</span> <span class="n">keys7</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="k">elif</span> <span class="n">keyCount</span> <span class="o">&lt;</span> <span class="mi">320</span> <span class="p">:</span> <span class="n">keys8</span> <span class="o">=</span> <span class="n">keys8</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">key</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">metaDataTable</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
        <span class="c1"># Column name formatting</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">key</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Estimate!!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;!!&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="n">dictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">vals</span><span class="p">))</span>
  
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 2)</span>
    <span class="c1"># Get the actual Table with the data we want using </span>
    <span class="c1">#~~~~~~~~~~~~~~~    </span>
    
    <span class="c1"># The URL we call is contingent on if the Table we want is a Detailed or Subject table</span>
    <span class="n">url1</span> <span class="o">=</span> <span class="s1">&#39;https://api.census.gov/data/20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;/acs/acs5?&#39;</span>
    <span class="n">url2</span> <span class="o">=</span> <span class="s1">&#39;https://api.census.gov/data/20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;/acs/acs5/subject?&#39;</span>
    <span class="n">base</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">tableId</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="n">base</span> <span class="o">=</span> <span class="n">url1</span> 
    <span class="k">if</span> <span class="n">tableId</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="n">base</span> <span class="o">=</span> <span class="n">url2</span>
      
    <span class="c1"># The addKey function only works after the first set of columns has been downloaded</span>
    <span class="c1"># Download First set of Tract columns</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">base</span><span class="o">+</span><span class="n">urlencode</span><span class="p">(</span><span class="n">getParams</span><span class="p">(</span><span class="n">keys1</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># Download First set of Aggregate City data </span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">base</span><span class="o">+</span><span class="n">urlencode</span><span class="p">(</span><span class="n">getCityParams</span><span class="p">(</span><span class="n">keys1</span><span class="p">))</span>
    <span class="n">table2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
    <span class="n">table2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">table2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">table2</span> <span class="o">=</span> <span class="n">table2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">table2</span><span class="p">[</span><span class="s1">&#39;tract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;010000&#39;</span>
    
    <span class="c1"># Merge EM</span>
    <span class="c1">#table = pd.concat([table, table2], keys=[&quot;NAME&quot;,&quot;state&quot;,&quot;county&quot;,], axis=0)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">table</span><span class="p">,</span> <span class="n">table2</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">table</span><span class="p">,</span> <span class="n">table2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Now we can repetedly use this function to add as many columns as there are keys listed from the meta data table</span>
    <span class="k">if</span> <span class="n">keys2</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">table</span> <span class="o">=</span> <span class="n">addKeys</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">keys2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keys3</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">table</span> <span class="o">=</span> <span class="n">addKeys</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">keys3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keys4</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">table</span> <span class="o">=</span> <span class="n">addKeys</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">keys4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keys5</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">table</span> <span class="o">=</span> <span class="n">addKeys</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">keys5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keys6</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">table</span> <span class="o">=</span> <span class="n">addKeys</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">keys6</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keys7</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">table</span> <span class="o">=</span> <span class="n">addKeys</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">keys7</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keys8</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">table</span> <span class="o">=</span> <span class="n">addKeys</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">keys8</span><span class="p">)</span>
      
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 3)</span>
    <span class="c1"># Prepare Column Names using the meta data table. The raw data has columnsNames in the first row, as well.</span>
    <span class="c1"># Replace column ID&#39;s with labels from the dictionary where applicable (should be always)</span>
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of Columns&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span> <span class="p">)</span>

    <span class="n">header</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span> <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">header</span>

    <span class="c1"># Prettify Names. Only happens with Baltimore...</span>
    <span class="n">table</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;, Baltimore city, Maryland&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">table</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">][</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Baltimore city, Maryland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Baltimore City&#39;</span> 
    
    <span class="c1"># Convert to Integers Columns from Strings where Applicable</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    
    <span class="c1"># Set the &#39;NAME&#39; Column as the index dropping the default increment</span>
    <span class="n">table</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">saveAcs</span><span class="p">:</span>
      <span class="c1"># Save the raw data as &#39;TABLEID_5yYEAR.csv&#39;</span>
      <span class="n">table</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="o">+</span><span class="n">state</span><span class="o">+</span><span class="n">county</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">tableId</span><span class="o">+</span><span class="s1">&#39;_5y&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_est_Original.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
      <span class="c1"># Remove the id in the column names &amp; Save the data as &#39;TABLEID_5yYEAR_est.csv&#39;</span>
      <span class="n">saveThis</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span> <span class="n">columns</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[:]</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;NAME&quot;</span><span class="p">,</span><span class="s2">&quot;state&quot;</span><span class="p">,</span><span class="s2">&quot;county&quot;</span><span class="p">,</span><span class="s2">&quot;tract&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">12</span><span class="p">:]</span> <span class="p">)</span>  <span class="p">)</span>
      <span class="n">saveThis</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="o">+</span><span class="n">state</span><span class="o">+</span><span class="n">county</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">tableId</span><span class="o">+</span><span class="s1">&#39;_5y&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_est.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now use this function to Download the Data!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">dataplay.acsDownload</span> <span class="kn">import</span> <span class="n">retrieve_acs_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use &#34;pip install psycopg2-binary&#34; instead. For details see: &lt;http://initd.org/psycopg/docs/install.html#binary-install-from-pypi&gt;.
  &#34;&#34;&#34;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Our download function will use Baltimore City&#39;s tract, county and state as internal paramters</span>
<span class="c1"># Change these values in the cell below using different geographic reference codes will change those parameters</span>
<span class="n">tract</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;510&#39;</span>
<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span>

<span class="c1"># Specify the download parameters the function will receieve here</span>
<span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B19001&#39;</span>
<span class="n">year</span> <span class="o">=</span> <span class="s1">&#39;17&#39;</span>
<span class="n">saveAcs</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of Columns 17
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10_000</th>
      <th>B19001_003E_Total_$10_000_to_$14_999</th>
      <th>B19001_004E_Total_$15_000_to_$19_999</th>
      <th>B19001_005E_Total_$20_000_to_$24_999</th>
      <th>B19001_006E_Total_$25_000_to_$29_999</th>
      <th>B19001_007E_Total_$30_000_to_$34_999</th>
      <th>B19001_008E_Total_$35_000_to_$39_999</th>
      <th>B19001_009E_Total_$40_000_to_$44_999</th>
      <th>B19001_010E_Total_$45_000_to_$49_999</th>
      <th>B19001_011E_Total_$50_000_to_$59_999</th>
      <th>B19001_012E_Total_$60_000_to_$74_999</th>
      <th>B19001_013E_Total_$75_000_to_$99_999</th>
      <th>B19001_014E_Total_$100_000_to_$124_999</th>
      <th>B19001_015E_Total_$125_000_to_$149_999</th>
      <th>B19001_016E_Total_$150_000_to_$199_999</th>
      <th>B19001_017E_Total_$200_000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>tract</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Census Tract 1901</th>
      <td>796</td>
      <td>237</td>
      <td>76</td>
      <td>85</td>
      <td>38</td>
      <td>79</td>
      <td>43</td>
      <td>36</td>
      <td>35</td>
      <td>15</td>
      <td>43</td>
      <td>45</td>
      <td>39</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>14</td>
      <td>24</td>
      <td>510</td>
      <td>190100</td>
    </tr>
    <tr>
      <th>Census Tract 1902</th>
      <td>695</td>
      <td>63</td>
      <td>87</td>
      <td>93</td>
      <td>6</td>
      <td>58</td>
      <td>30</td>
      <td>14</td>
      <td>29</td>
      <td>23</td>
      <td>38</td>
      <td>113</td>
      <td>70</td>
      <td>6</td>
      <td>32</td>
      <td>11</td>
      <td>22</td>
      <td>24</td>
      <td>510</td>
      <td>190200</td>
    </tr>
    <tr>
      <th>Census Tract 2201</th>
      <td>2208</td>
      <td>137</td>
      <td>229</td>
      <td>124</td>
      <td>52</td>
      <td>78</td>
      <td>87</td>
      <td>50</td>
      <td>80</td>
      <td>13</td>
      <td>217</td>
      <td>66</td>
      <td>159</td>
      <td>205</td>
      <td>167</td>
      <td>146</td>
      <td>398</td>
      <td>24</td>
      <td>510</td>
      <td>220100</td>
    </tr>
    <tr>
      <th>Census Tract 2303</th>
      <td>632</td>
      <td>3</td>
      <td>20</td>
      <td>0</td>
      <td>39</td>
      <td>7</td>
      <td>0</td>
      <td>29</td>
      <td>8</td>
      <td>9</td>
      <td>44</td>
      <td>29</td>
      <td>98</td>
      <td>111</td>
      <td>63</td>
      <td>94</td>
      <td>78</td>
      <td>24</td>
      <td>510</td>
      <td>230300</td>
    </tr>
    <tr>
      <th>Census Tract 2502.07</th>
      <td>836</td>
      <td>102</td>
      <td>28</td>
      <td>101</td>
      <td>64</td>
      <td>104</td>
      <td>76</td>
      <td>41</td>
      <td>40</td>
      <td>47</td>
      <td>72</td>
      <td>28</td>
      <td>60</td>
      <td>19</td>
      <td>27</td>
      <td>15</td>
      <td>12</td>
      <td>24</td>
      <td>510</td>
      <td>250207</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Secondary-Dataset">Get the Secondary Dataset<a class="anchor-link" href="#Get-the-Secondary-Dataset"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get the Second dataset. </span>
<span class="c1"># Our Example dataset contains Polygon Geometry information. </span>
<span class="c1"># We want to merge this over to our principle dataset. we will grab it by matching on either CSA or Tract</span>

<span class="c1"># The url listed below is public.</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Crosswalk Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Boundaries Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vTPKW6YOHPFvkw3FM3m5y67-Aa5ZlrM0Ee1Fb57wlGuldr99sEvVWnkej30FXhSb3j8o9gr8izq2ZRP/pub?output=csv&#39;</span><span class="p">)</span>

<span class="n">inFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Please enter the location of your file : </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>

<span class="n">crosswalk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="n">inFile</span> <span class="p">)</span>
<span class="n">crosswalk</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Crosswalk Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
Boundaries Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vTPKW6YOHPFvkw3FM3m5y67-Aa5ZlrM0Ee1Fb57wlGuldr99sEvVWnkej30FXhSb3j8o9gr8izq2ZRP/pub?output=csv

 Please enter the location of your file : 
https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRACT2010</th>
      <th>GEOID2010</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10100</td>
      <td>24510010100</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10200</td>
      <td>24510010200</td>
      <td>Patterson Park North &amp; East</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10300</td>
      <td>24510010300</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10400</td>
      <td>24510010400</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10500</td>
      <td>24510010500</td>
      <td>Fells Point</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Perform-Merge-&amp;-Save">Perform Merge &amp; Save<a class="anchor-link" href="#Perform-Merge-&amp;-Save"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This little piece of code does nothing important but serves as a </span>
<span class="c1"># friendly reminder of the 4 basic join types.</span>

<span class="c1"># Left - returns all left records, only includes the right record if it has a match</span>
<span class="c1"># Right - Returns all right records, only includes the left record if it has a match </span>
<span class="c1"># Full - Returns all records regardless of keys matching</span>
<span class="c1"># Inner - Returns only records where a key match</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://docs.trifacta.com/download/attachments/123830435/JoinVennDiagram.png&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">328</span><span class="p">,</span> <span class="mi">328</span>
<span class="n">img</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">ANTIALIAS</span><span class="p">)</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,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
AElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get Columns from both datasets to match on</span>
<span class="c1"># You can get these values from the column values above.</span>

<span class="c1"># Our Examples will work with the prompted values</span>

<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Princpal Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on principal column: (&#39;tract&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Crosswalk Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on crosswalk column: (&#39;TRACT2010&#39;, or, &#39;TRACTCE10&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>

<span class="c1"># Specify how the merge will be performed</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Princpal Columns Index([&#39;B19001_001E_Total&#39;, &#39;B19001_002E_Total_Less_than_$10_000&#39;,
       &#39;B19001_003E_Total_$10_000_to_$14_999&#39;,
       &#39;B19001_004E_Total_$15_000_to_$19_999&#39;,
       &#39;B19001_005E_Total_$20_000_to_$24_999&#39;,
       &#39;B19001_006E_Total_$25_000_to_$29_999&#39;,
       &#39;B19001_007E_Total_$30_000_to_$34_999&#39;,
       &#39;B19001_008E_Total_$35_000_to_$39_999&#39;,
       &#39;B19001_009E_Total_$40_000_to_$44_999&#39;,
       &#39;B19001_010E_Total_$45_000_to_$49_999&#39;,
       &#39;B19001_011E_Total_$50_000_to_$59_999&#39;,
       &#39;B19001_012E_Total_$60_000_to_$74_999&#39;,
       &#39;B19001_013E_Total_$75_000_to_$99_999&#39;,
       &#39;B19001_014E_Total_$100_000_to_$124_999&#39;,
       &#39;B19001_015E_Total_$125_000_to_$149_999&#39;,
       &#39;B19001_016E_Total_$150_000_to_$199_999&#39;,
       &#39;B19001_017E_Total_$200_000_or_more&#39;, &#39;state&#39;, &#39;county&#39;, &#39;tract&#39;],
      dtype=&#39;object&#39;)
Left on principal column: (&#39;TRACT2010&#39;) 
tract
Crosswalk Columns Index([&#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)
Right on crosswalk column: (&#39;TRACTCE10&#39;, or, &#39;tract&#39;) 
TRACT2010
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We will perform a left merge in this example.</span>
<span class="c1"># It will return our Principal dataset with columns from the second dataset appended to records where their specified columns match.</span>

<span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (left, right, outer, inner) &quot;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>How: (left, right, outer, inner) left
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Actually perfrom the merge</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crosswalk</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">merged_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10_000</th>
      <th>B19001_003E_Total_$10_000_to_$14_999</th>
      <th>B19001_004E_Total_$15_000_to_$19_999</th>
      <th>B19001_005E_Total_$20_000_to_$24_999</th>
      <th>B19001_006E_Total_$25_000_to_$29_999</th>
      <th>B19001_007E_Total_$30_000_to_$34_999</th>
      <th>B19001_008E_Total_$35_000_to_$39_999</th>
      <th>B19001_009E_Total_$40_000_to_$44_999</th>
      <th>B19001_010E_Total_$45_000_to_$49_999</th>
      <th>B19001_011E_Total_$50_000_to_$59_999</th>
      <th>B19001_012E_Total_$60_000_to_$74_999</th>
      <th>B19001_013E_Total_$75_000_to_$99_999</th>
      <th>B19001_014E_Total_$100_000_to_$124_999</th>
      <th>B19001_015E_Total_$125_000_to_$149_999</th>
      <th>B19001_016E_Total_$150_000_to_$199_999</th>
      <th>B19001_017E_Total_$200_000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>TRACT2010</th>
      <th>GEOID2010</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>796</td>
      <td>237</td>
      <td>76</td>
      <td>85</td>
      <td>38</td>
      <td>79</td>
      <td>43</td>
      <td>36</td>
      <td>35</td>
      <td>15</td>
      <td>43</td>
      <td>45</td>
      <td>39</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>14</td>
      <td>24</td>
      <td>510</td>
      <td>190100</td>
      <td>24510190100</td>
      <td>Southwest Baltimore</td>
    </tr>
    <tr>
      <th>1</th>
      <td>695</td>
      <td>63</td>
      <td>87</td>
      <td>93</td>
      <td>6</td>
      <td>58</td>
      <td>30</td>
      <td>14</td>
      <td>29</td>
      <td>23</td>
      <td>38</td>
      <td>113</td>
      <td>70</td>
      <td>6</td>
      <td>32</td>
      <td>11</td>
      <td>22</td>
      <td>24</td>
      <td>510</td>
      <td>190200</td>
      <td>24510190200</td>
      <td>Southwest Baltimore</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2208</td>
      <td>137</td>
      <td>229</td>
      <td>124</td>
      <td>52</td>
      <td>78</td>
      <td>87</td>
      <td>50</td>
      <td>80</td>
      <td>13</td>
      <td>217</td>
      <td>66</td>
      <td>159</td>
      <td>205</td>
      <td>167</td>
      <td>146</td>
      <td>398</td>
      <td>24</td>
      <td>510</td>
      <td>220100</td>
      <td>24510220100</td>
      <td>Inner Harbor/Federal Hill</td>
    </tr>
    <tr>
      <th>3</th>
      <td>632</td>
      <td>3</td>
      <td>20</td>
      <td>0</td>
      <td>39</td>
      <td>7</td>
      <td>0</td>
      <td>29</td>
      <td>8</td>
      <td>9</td>
      <td>44</td>
      <td>29</td>
      <td>98</td>
      <td>111</td>
      <td>63</td>
      <td>94</td>
      <td>78</td>
      <td>24</td>
      <td>510</td>
      <td>230300</td>
      <td>24510230300</td>
      <td>South Baltimore</td>
    </tr>
    <tr>
      <th>4</th>
      <td>836</td>
      <td>102</td>
      <td>28</td>
      <td>101</td>
      <td>64</td>
      <td>104</td>
      <td>76</td>
      <td>41</td>
      <td>40</td>
      <td>47</td>
      <td>72</td>
      <td>28</td>
      <td>60</td>
      <td>19</td>
      <td>27</td>
      <td>15</td>
      <td>12</td>
      <td>24</td>
      <td>510</td>
      <td>250207</td>
      <td>24510250207</td>
      <td>Cherry Hill</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>196</th>
      <td>1219</td>
      <td>84</td>
      <td>41</td>
      <td>42</td>
      <td>72</td>
      <td>39</td>
      <td>94</td>
      <td>69</td>
      <td>38</td>
      <td>41</td>
      <td>87</td>
      <td>124</td>
      <td>107</td>
      <td>40</td>
      <td>91</td>
      <td>93</td>
      <td>157</td>
      <td>24</td>
      <td>510</td>
      <td>272005</td>
      <td>24510272005</td>
      <td>Cross-Country/Cheswolde</td>
    </tr>
    <tr>
      <th>197</th>
      <td>883</td>
      <td>78</td>
      <td>27</td>
      <td>31</td>
      <td>3</td>
      <td>33</td>
      <td>31</td>
      <td>30</td>
      <td>43</td>
      <td>23</td>
      <td>52</td>
      <td>96</td>
      <td>133</td>
      <td>65</td>
      <td>67</td>
      <td>53</td>
      <td>118</td>
      <td>24</td>
      <td>510</td>
      <td>120201</td>
      <td>24510120201</td>
      <td>Greater Charles Village/Barclay</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1835</td>
      <td>155</td>
      <td>109</td>
      <td>136</td>
      <td>106</td>
      <td>198</td>
      <td>94</td>
      <td>130</td>
      <td>118</td>
      <td>83</td>
      <td>71</td>
      <td>162</td>
      <td>135</td>
      <td>180</td>
      <td>0</td>
      <td>43</td>
      <td>115</td>
      <td>24</td>
      <td>510</td>
      <td>272004</td>
      <td>24510272004</td>
      <td>Cross-Country/Cheswolde</td>
    </tr>
    <tr>
      <th>199</th>
      <td>1679</td>
      <td>347</td>
      <td>165</td>
      <td>130</td>
      <td>125</td>
      <td>64</td>
      <td>78</td>
      <td>80</td>
      <td>25</td>
      <td>50</td>
      <td>168</td>
      <td>99</td>
      <td>166</td>
      <td>70</td>
      <td>54</td>
      <td>29</td>
      <td>29</td>
      <td>24</td>
      <td>510</td>
      <td>272006</td>
      <td>24510272006</td>
      <td>Glen-Fallstaff</td>
    </tr>
    <tr>
      <th>200</th>
      <td>239791</td>
      <td>29106</td>
      <td>15759</td>
      <td>13992</td>
      <td>11786</td>
      <td>12818</td>
      <td>12304</td>
      <td>10610</td>
      <td>10261</td>
      <td>9641</td>
      <td>18773</td>
      <td>21563</td>
      <td>25273</td>
      <td>16094</td>
      <td>10011</td>
      <td>10712</td>
      <td>11088</td>
      <td>24</td>
      <td>510</td>
      <td>10000</td>
      <td>0</td>
      <td>Baltimore City</td>
    </tr>
  </tbody>
</table>
<p>201 rows  22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, our Census data will now have a CSA appended to it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save Data to User Specified File</span>

<span class="kn">import</span> <span class="nn">csv</span>

<span class="n">outFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the new Filename to save the data to (&#39;acs_csa_merge_test&#39;: &quot;</span> <span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outFile</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Please enter the new Filename to save the data to : merged_test
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Final-Result">Final Result<a class="anchor-link" href="#Final-Result"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import needed modules</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">csv</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your Principal file: &quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Principal Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Crosswalk Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Boundaries Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vTPKW6YOHPFvkw3FM3m5y67-Aa5ZlrM0Ee1Fb57wlGuldr99sEvVWnkej30FXhSb3j8o9gr8izq2ZRP/pub?output=csv&#39;</span><span class="p">)</span>

<span class="n">crosswalk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your crosswalk file: &quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Crosswalk Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on: &quot;</span> <span class="p">)</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on: &quot;</span> <span class="p">)</span>
<span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (left, right, outer, inner) &quot;</span> <span class="p">)</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crosswalk</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Save the data</span>
<span class="c1"># Save the data</span>
<span class="n">saveFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Save File (&#39;Y&#39; or &#39;N&#39;): &quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span> <span class="ow">or</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
  <span class="n">outFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Saved Filename (Do not include the file extension ): &quot;</span><span class="p">)</span>
  <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outFile</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Please enter the location of your Principal file: 24510_B19001_5y17_est.csv
Principal Columns Index([&#39;NAME&#39;, &#39;Total&#39;, &#39;Total_Less_than_$10_000&#39;, &#39;Total_$10_000_to_$14_999&#39;,
       &#39;Total_$15_000_to_$19_999&#39;, &#39;Total_$20_000_to_$24_999&#39;,
       &#39;Total_$25_000_to_$29_999&#39;, &#39;Total_$30_000_to_$34_999&#39;,
       &#39;Total_$35_000_to_$39_999&#39;, &#39;Total_$40_000_to_$44_999&#39;,
       &#39;Total_$45_000_to_$49_999&#39;, &#39;Total_$50_000_to_$59_999&#39;,
       &#39;Total_$60_000_to_$74_999&#39;, &#39;Total_$75_000_to_$99_999&#39;,
       &#39;Total_$100_000_to_$124_999&#39;, &#39;Total_$125_000_to_$149_999&#39;,
       &#39;Total_$150_000_to_$199_999&#39;, &#39;Total_$200_000_or_more&#39;, &#39;state&#39;,
       &#39;county&#39;, &#39;tract&#39;],
      dtype=&#39;object&#39;)
Crosswalk Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
Boundaries Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vTPKW6YOHPFvkw3FM3m5y67-Aa5ZlrM0Ee1Fb57wlGuldr99sEvVWnkej30FXhSb3j8o9gr8izq2ZRP/pub?output=csv
Please enter the location of your crosswalk file: https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
Crosswalk Columns Index([&#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)

Left on: tract
Right on: TRACT2010
How: (left, right, outer, inner) left
Save File (&#39;Y&#39; or &#39;N&#39;): N
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Advanced">Advanced<a class="anchor-link" href="#Advanced"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Intro</strong></p>
<p>The following Python function is a bulked out version of the previous notes.</p>
<ul>
<li>It contains everything from the tutorial plus more.</li>
<li>It can be imported and used in future projects or stand alone.</li>
</ul>
<p><strong>Description:</strong> add columns of data from a foreign dataset into a primary dataset along set parameters.</p>
<p><strong>Purpose:</strong> Makes Merging datasets simple</p>
<p><strong>Services</strong></p>
<ul>
<li>Merge two datasets without a crosswalk</li>
<li>Merge two datasets with a crosswalk</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@title Run: Create mergeDatasets()</span>

<span class="c1"># Geometry_DS = https://docs.google.com/spreadsheets/d/e/2PACX-1vTPKW6YOHPFvkw3FM3m5y67-Aa5ZlrM0Ee1Fb57wlGuldr99sEvVWnkej30FXhSb3j8o9gr8izq2ZRP/pub?output=csv</span>
<span class="c1"># Data_DS = https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv</span>

<span class="c1"># Import needed modules</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">csv</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="o">,</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 

<span class="k">def</span> <span class="nf">mergeDatasets</span><span class="p">(</span><span class="n">left_ds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                  <span class="n">right_ds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                  <span class="n">crosswalk_ds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                  <span class="n">use_crosswalk</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="n">left_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                  <span class="n">right_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                  <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                  <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                  <span class="n">merge_how</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> 
    
  <span class="c1"># Decide to perform a merge or commit a pull</span>
  <span class="k">def</span> <span class="nf">mergeOrPull</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="p">):</span>  
    
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="p">):</span>
      <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
      <span class="c1"># df.drop(left_on, axis=1)</span>
      <span class="n">df</span><span class="p">[</span><span class="n">right_on</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">right_on</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;empty&#39;</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">pull</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="p">):</span>
      <span class="n">crswlk</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cw</span><span class="p">[</span><span class="n">right_on</span><span class="p">],</span> <span class="n">cw</span><span class="p">[</span><span class="n">how</span><span class="p">]</span>  <span class="p">)</span> <span class="p">)</span>
      <span class="n">dtype</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">left_on</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
      <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span><span class="s1">&#39;object&#39;</span><span class="p">:</span>  <span class="n">df</span><span class="p">[</span><span class="n">how</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">crswlk</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">left_on</span><span class="p">]),</span> <span class="s2">&quot;empty&quot;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span><span class="p">:</span> 
        <span class="n">df</span><span class="p">[</span><span class="n">how</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">crswlk</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">left_on</span><span class="p">]),</span> <span class="s2">&quot;empty&quot;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">df</span>
    
    <span class="n">mergeType</span> <span class="o">=</span> <span class="n">how</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="s1">&#39;inner&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">mergeType</span><span class="p">:</span> <span class="k">return</span> <span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">pull</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="p">)</span>
    
  
    
  <span class="c1"># Filter between matched records and not.</span>
  <span class="k">def</span> <span class="nf">filterEmpties</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">how</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="s1">&#39;inner&#39;</span><span class="p">]:</span> <span class="n">how</span> <span class="o">=</span> <span class="n">right_on</span>
    <span class="n">nomatch</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">how</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;empty&#39;</span><span class="p">]</span>
    <span class="n">nomatch</span> <span class="o">=</span> <span class="n">nomatch</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">nomatch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="c1"># Do the same thing with our foreign tracts</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Local Column Values Not Matched &#39;</span><span class="p">)</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">nomatch</span><span class="p">[</span><span class="n">left_on</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="p">)</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nomatch</span><span class="p">[</span><span class="n">left_on</span><span class="p">]))</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Crosswalk Unique Column Values&#39;</span><span class="p">)</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">cw</span><span class="p">[</span><span class="n">right_on</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="p">)</span>
    
    <span class="c1"># Create a new column with the tracts value mapped to its corresponding value from the crossswalk</span>
    <span class="n">df</span><span class="p">[</span><span class="n">how</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;empty&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">how</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># cw = cw.sort_values(by=how, ascending=True)</span>
    <span class="k">return</span> <span class="n">df</span>

  <span class="c1"># Check Crosswalk Params</span>
  <span class="k">def</span> <span class="nf">handleCrosswalkDataset</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    <span class="n">noDataset</span> <span class="o">=</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span>
    <span class="n">noColumns</span> <span class="o">=</span> <span class="p">(</span><span class="ow">not</span> <span class="n">crosswalk_left_col</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">crosswalk_right_col</span><span class="p">)</span>
    <span class="n">columnDne</span> <span class="o">=</span> <span class="n">checkColumns</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">)</span>
    <span class="n">columnDne</span> <span class="o">=</span> <span class="n">checkColumns</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">noDataset</span> <span class="ow">or</span> <span class="n">noColumns</span> <span class="p">):</span> <span class="k">return</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="o">*</span><span class="n">getMergeParams</span><span class="p">()</span> <span class="p">);</span>



  <span class="k">def</span> <span class="nf">handleMergeHow</span><span class="p">(</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    <span class="n">howList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="s1">&#39;inner&#39;</span><span class="p">]</span> 
    <span class="n">mergeHowInHowList</span> <span class="o">=</span> <span class="n">merge_how</span> <span class="ow">in</span> <span class="n">howList</span>
    <span class="n">mergeHowInRightDf</span> <span class="o">=</span> <span class="n">checkColumns</span><span class="p">(</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">)</span>
    <span class="n">mergeHowExists</span> <span class="o">=</span> <span class="p">(</span><span class="n">mergeHowInRightDf</span> <span class="ow">or</span> <span class="n">mergeHowInHowList</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">mergeHowExists</span> <span class="p">):</span> <span class="k">return</span> <span class="n">merge_how</span>
    <span class="k">elif</span> <span class="p">(</span> <span class="ow">not</span> <span class="n">interactive</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="k">try</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valid Column Not Given&#39;</span><span class="p">);</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> 1) Pull A single Column from the Right Dataset: &quot;</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OR&quot;</span><span class="p">);</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2) Join Operation: (left, right, outer, inner, columnName) &quot;</span> <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Please select a value from either list&quot;</span><span class="p">);</span>
        <span class="n">merge_how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Column Name: &quot;</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">handleMergeHow</span><span class="p">(</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span><span class="p">);</span>
      <span class="k">except</span><span class="p">:</span> <span class="k">return</span> <span class="n">handleMergeHow</span><span class="p">(</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span><span class="p">);</span>



  <span class="k">def</span> <span class="nf">processColumn</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    <span class="c1"># Check Column in Dataset </span>
    <span class="n">colExists</span> <span class="o">=</span> <span class="n">checkColumns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="n">noColNotInteractive</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">colExists</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">interactive</span>
    <span class="k">if</span> <span class="n">colExists</span><span class="p">:</span> <span class="k">return</span> <span class="n">col</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">noColNotInteractive</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">try</span><span class="p">:</span> 
          <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valid Column Not Given&#39;</span><span class="p">);</span>
          <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
          <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please provide a dataset column name from the list above.&quot;</span><span class="p">);</span>
          <span class="n">col</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Column Name: &quot;</span> <span class="p">)</span>
          <span class="n">colExists</span> <span class="o">=</span> <span class="n">checkColumns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">colExists</span><span class="p">):</span> <span class="k">return</span> <span class="n">col</span>
          <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">processColumn</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">);</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">return</span> <span class="n">processColumn</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">);</span>






  <span class="c1"># Returns a DF if provided a DF or URL. False otherwise. </span>
  <span class="k">def</span> <span class="nf">retrieveDatasetFromUrl</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">datasetExists</span> <span class="o">=</span> <span class="n">checkDataSetExists</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">urlGiven</span> <span class="o">=</span> <span class="n">df</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">datasetExists</span>
    <span class="k">if</span> <span class="n">datasetExists</span><span class="p">:</span> <span class="k">return</span> <span class="n">df</span>
    <span class="k">elif</span> <span class="p">(</span> <span class="n">urlGiven</span> <span class="p">):</span>
      <span class="k">try</span><span class="p">:</span> 
        <span class="n">urlGiven</span> <span class="o">=</span> <span class="n">df</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="n">df</span> <span class="p">)</span>
        <span class="n">datasetExists</span> <span class="o">=</span> <span class="n">checkDataSetExists</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">datasetExists</span><span class="p">:</span> <span class="k">return</span> <span class="n">df</span>
      <span class="k">except</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span><span class="p">;</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>

  <span class="c1"># If !DF and interactive, re-processDataset. False otherwise.</span>
  <span class="k">def</span> <span class="nf">retrieveUrlForDataset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    <span class="n">dsExists</span> <span class="o">=</span> <span class="n">checkDataSetExists</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">dsExists</span> <span class="p">):</span> <span class="k">return</span> <span class="n">df</span>
    <span class="k">if</span> <span class="p">(</span> <span class="ow">not</span> <span class="n">dsExists</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">interactive</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="ow">not</span> <span class="n">dsExists</span> <span class="ow">and</span> <span class="n">interactive</span><span class="p">):</span> 
      <span class="n">df</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please provide a new dataset URL: &quot;</span> <span class="p">);</span>
      <span class="k">return</span> <span class="n">processDataset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>

  <span class="c1"># Ensures a Pandas DF is returned. </span>
  <span class="c1"># If not Interactive, may return FALSE.</span>
  <span class="k">def</span> <span class="nf">processDataset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    <span class="c1"># Returns a DF if provided a DF or URL. False otherwise. </span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">retrieveDatasetFromUrl</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="c1"># If !DF and interactive, re-processDataset w/a new URL</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">retrieveUrlForDataset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>





  <span class="c1"># Check Dataset Params</span>
  <span class="k">def</span> <span class="nf">handleDatasetAndColumns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    <span class="n">dfStatus</span> <span class="o">=</span> <span class="n">colStatus</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># Ensure A Dataset is being handled</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">processDataset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="ow">not</span> <span class="n">checkDataSetExists</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="p">):</span> <span class="n">dfStatus</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Ensure A Column Exists</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">processColumn</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">col</span> <span class="o">==</span> <span class="kc">False</span> <span class="p">):</span> <span class="n">colStatus</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">dfStatus</span><span class="p">,</span> <span class="n">colStatus</span>




  <span class="c1"># Ensure data types are the same</span>
  <span class="k">def</span> <span class="nf">coerceDtypes</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">foreignDtype</span> <span class="o">=</span> <span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
    <span class="n">localDtype</span> <span class="o">=</span> <span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>  

    <span class="n">localIsNumber</span> <span class="o">=</span> <span class="n">localDtype</span> <span class="o">==</span> <span class="s1">&#39;float64&#39;</span> <span class="ow">or</span> <span class="n">localDtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span>
    <span class="n">foreignIsNumber</span> <span class="o">=</span> <span class="n">foreignDtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span> <span class="ow">or</span> <span class="n">foreignDtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span>

    <span class="k">if</span> <span class="n">foreignIsNumber</span><span class="p">:</span> <span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">1321321321321325</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">localIsNumber</span><span class="p">:</span> <span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">1321321321321325</span><span class="p">)</span>
    
    <span class="c1"># Coerce one way or the other if possible</span>
    <span class="k">if</span> <span class="n">localIsNumber</span> <span class="ow">and</span> <span class="n">foreignDtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converting Foreign Key from Object to Int&#39;</span> <span class="p">)</span>
      <span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
      
    <span class="k">if</span> <span class="n">localDtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="ow">and</span> <span class="n">foreignIsNumber</span><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converting Foreign Key from Object to Int&#39;</span> <span class="p">)</span>
      <span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="c1"># Coerce INTS AND FLOATS if possible        </span>
    <span class="k">if</span> <span class="n">localDtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span> <span class="ow">and</span> <span class="n">foreignDtype</span> <span class="o">==</span> <span class="s1">&#39;float64&#39;</span><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converting Local Key from Int to float&#39;</span> <span class="p">)</span>
      <span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">localDtype</span> <span class="o">==</span> <span class="s1">&#39;float64&#39;</span> <span class="ow">and</span> <span class="n">foreignDtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converting Local Key from float64 to Int&#39;</span> <span class="p">)</span>
      <span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">foreignDtype</span> <span class="o">=</span> <span class="n">right_ds</span><span class="p">[</span><span class="n">right_col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
    <span class="n">localDtype</span> <span class="o">=</span> <span class="n">left_ds</span><span class="p">[</span><span class="n">left_col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>

    <span class="c1"># Return the data and the coerce status</span>
    <span class="k">if</span> <span class="n">localDtype</span> <span class="o">==</span> <span class="n">foreignDtype</span><span class="p">:</span> <span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">status</span>




  <span class="c1"># Check if the columns actually exist</span>
  <span class="k">def</span> <span class="nf">checkColumns</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span> <span class="k">return</span> <span class="p">{</span><span class="n">column</span><span class="p">}</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> 
  <span class="c1"># Check if the DataSet actually exist</span>
  <span class="k">def</span> <span class="nf">checkDataSetExists</span><span class="p">(</span><span class="n">df</span><span class="p">):</span> <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>

  <span class="c1"># This function uses all the other functions</span>
  <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">use_crosswalk</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> 
           <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span><span class="p">):</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Handling Left Dataset&#39;</span><span class="p">);</span>
    <span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">dfStatus</span><span class="p">,</span> <span class="n">colStatus</span> <span class="o">=</span> <span class="n">handleDatasetAndColumns</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dfStatus</span> <span class="ow">and</span> <span class="n">colStatus</span> <span class="ow">and</span> <span class="n">interactive</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Left Dataset and Columns are Valid&#39;</span><span class="p">);</span>
    <span class="k">elif</span><span class="p">(</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dfStatus</span> <span class="ow">and</span> <span class="n">colStatus</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">interactive</span><span class="p">):</span>
      <span class="k">return</span> <span class="s1">&#39;ERROR: Error with Left Dataset and or Column&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Handling Right Dataset&#39;</span><span class="p">);</span>
    <span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">dfStatus</span><span class="p">,</span> <span class="n">colStatus</span>  <span class="o">=</span> <span class="n">handleDatasetAndColumns</span><span class="p">(</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dfStatus</span> <span class="ow">and</span> <span class="n">colStatus</span> <span class="ow">and</span> <span class="n">interactive</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Right Dataset and Columns are Valid&#39;</span><span class="p">);</span>
    <span class="k">elif</span><span class="p">(</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dfStatus</span> <span class="ow">and</span> <span class="n">colStatus</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">interactive</span><span class="p">):</span>
      <span class="k">return</span> <span class="s1">&#39;ERROR: Error with Right Dataset and or Column&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Checking the merge_how Parameter&#39;</span><span class="p">);</span>
    <span class="n">merge_how</span> <span class="o">=</span> <span class="n">handleMergeHow</span><span class="p">(</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">merge_how</span> <span class="ow">and</span> <span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;merge_how operator is Valid&#39;</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span> <span class="ow">not</span>  <span class="n">merge_how</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">interactive</span> <span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;ERROR: Error with merge_how Paramter&#39;</span>

    <span class="c1"># Returns true if a DF. False if URL</span>
    <span class="n">crosswalkSupplied</span> <span class="o">=</span> <span class="n">checkDataSetExists</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">crosswalkSupplied</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="n">crosswalkSupplied</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">interactive</span> <span class="ow">and</span> <span class="n">use_crosswalk</span><span class="p">):</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Checking the Crosswalk Parameter&#39;</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">crosswalkSupplied</span><span class="p">):</span>  
        <span class="n">use_crosswalk</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Are you using a crosswalk? &#39;True&#39; or &#39;False&#39;: &quot;</span> <span class="p">)</span>
        <span class="n">use_crosswalk</span> <span class="o">=</span> <span class="n">use_crosswalk</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">use_crosswalk</span> <span class="o">=</span> <span class="n">crosswalkSupplied</span>

    <span class="c1"># If a user is using a crosswalk, then assess match for left-cw, and right-cw.</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">use_crosswalk</span> <span class="p">):</span> 
      <span class="c1"># This will load our dataset if provided as a url.</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Handling Crosswalk Left Dataset Loading&#39;</span><span class="p">);</span>
      <span class="n">crosswalk_ds_discard</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">dfStatus</span><span class="p">,</span> <span class="n">colStatus</span> <span class="o">=</span> <span class="n">handleDatasetAndColumns</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
      <span class="c1"># the first Item is our Dataset, which we discard the first time this data is called, kept the second.</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Handling Crosswalk Right Dataset Loading&#39;</span><span class="p">);</span>
      <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="n">dfStatus</span><span class="p">,</span> <span class="n">colStatus</span> <span class="o">=</span> <span class="n">handleDatasetAndColumns</span><span class="p">(</span><span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Assessment Completed&#39;</span><span class="p">);</span>

      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Ensuring Left-&gt;Crosswalk compatability&#39;</span><span class="p">)</span>
      <span class="n">left_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">status</span> <span class="o">=</span> <span class="n">coerceDtypes</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Ensuring Crosswalk-&gt;Right compatability&#39;</span><span class="p">)</span>
      <span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">status</span> <span class="o">=</span> <span class="n">coerceDtypes</span><span class="p">(</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">);</span>
    <span class="c1"># If a user is not using a crswk, then assess match for left-right.</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Ensuring Left-&gt;Right compatability&#39;</span><span class="p">)</span>
      <span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">status</span> <span class="o">=</span> <span class="n">coerceDtypes</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">status</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">interactive</span> <span class="p">):</span> 
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR: Foreign keys data types do not match&#39;</span><span class="p">);</span> 
      <span class="k">return</span> <span class="kc">False</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">status</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">interactive</span> <span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Could not resolve differences in data types.&#39;</span><span class="p">)</span>
      <span class="n">restart</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Would you like to restart?: &#39;True&#39; or &#39;False&#39;: &quot;</span> <span class="p">)</span>
      <span class="n">restart</span> <span class="o">=</span> <span class="n">restart</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span>
      <span class="k">if</span> <span class="n">restart</span> <span class="p">:</span> <span class="k">return</span> <span class="n">mergeDatasets</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GOODBYE&#39;</span><span class="p">);</span> <span class="k">return</span> <span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span><span class="n">use_crosswalk</span><span class="p">):</span> 
        <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span> 
          <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PERFORMING MERGE LEFT-&gt;CROSSWALK&#39;</span><span class="p">);</span>
          <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;left_on&#39;</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="s1">&#39;right_on&#39;</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="s1">&#39;how&#39;</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">);</span> 
        <span class="c1"># Perform the left-CW Merge using left_col, crosswalk_left_col then pull the crosswalk_right_col</span>
        <span class="n">left_ds</span> <span class="o">=</span> <span class="n">mergeOrPull</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">)</span>   
        <span class="c1"># Filter out columns not matched</span>
        <span class="n">left_ds</span> <span class="o">=</span> <span class="n">filterEmpties</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>
        <span class="c1"># set the new left_col as the crosswalk_right_col since it will be able to match to the right_col</span>
        <span class="n">left_col</span> <span class="o">=</span> <span class="n">crosswalk_right_col</span>

      <span class="c1"># If the crosswalk was needed, it has now been integrated in to the left table.</span>
      <span class="c1"># The crosswalk col corresponding to the right_col should exist in the left Table.</span>
      <span class="c1"># Merge the left and right tables now.</span>
      
      <span class="k">if</span><span class="p">(</span><span class="n">interactive</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PERFORMING MERGE LEFT-&gt;RIGHT&#39;</span><span class="p">);</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;left_col&#39;</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="s1">&#39;right_col&#39;</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="s1">&#39;how&#39;</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">);</span> 
      <span class="c1"># Perform the merge</span>
      <span class="n">left_ds</span> <span class="o">=</span> <span class="n">mergeOrPull</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">)</span>   
      <span class="c1"># Filter out columns not matched</span>
      <span class="n">left_ds</span> <span class="o">=</span> <span class="n">filterEmpties</span><span class="p">(</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">left_ds</span>

  <span class="k">return</span> <span class="n">main</span><span class="p">(</span> <span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="p">,</span> <span class="n">use_crosswalk</span><span class="p">,</span> <span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="p">,</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Function-Explanation">Function Explanation<a class="anchor-link" href="#Function-Explanation"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Input(s):</strong></p>
<ul>
<li>Dataset url</li>
<li>Crosswalk Url </li>
<li>Right On </li>
<li>Left On </li>
<li>How </li>
<li>New Filename </li>
</ul>
<p><strong>Output:</strong> File</p>
<p><strong>How it works:</strong></p>
<ul>
<li>Read in datasets</li>
<li><p>Perform Merge</p>
</li>
<li><p>If the 'how' parameter is equal to ['left', 'right', 'outer', 'inner']</p>
</li>
<li><ul>
<li>then a merge will be performed. </li>
</ul>
</li>
<li>If a column name is provided in the 'how' parameter</li>
<li><ul>
<li>then that single column will be pulled from the right dataset as a new column in the left_ds.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Diagrams">Function Diagrams<a class="anchor-link" href="#Function-Diagrams"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@title Run: Diagram the mergeDatasets()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@title Run: mergeDatasets Flow Chart</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@title Run: Gannt Chart  mergeDatasets()</span>
  
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@title Run: Sequence Diagram  mergeDatasets()</span>
  
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Examples">Function Examples<a class="anchor-link" href="#Function-Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Example-1">Interactive Example 1<a class="anchor-link" href="#Interactive-Example-1"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Table: FDIC Baltimore Banks</span>
<span class="c1"># Columns: Bank Name, Address(es), Census Tract</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vSHFrRSHva1f82ZQ7Uxwf3A1phqljj1oa2duGlZDM1vLtrm1GI5yHmpVX2ilTfMHQ/pub?gid=601362340&amp;single=true&amp;output=csv&#39;</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;Census Tract&#39;</span>

<span class="c1"># Table: Crosswalk Census Communities</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span>
<span class="n">right_col</span><span class="o">=</span><span class="s1">&#39;TRACT2010&#39;</span>


<span class="n">crosswalk_ds</span><span class="p">,</span> 
<span class="n">use_crosswalk</span><span class="p">,</span> 
<span class="n">crosswalk_left_col</span><span class="p">,</span> 
<span class="n">crosswalk_right_col</span><span class="p">,</span> 

<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">use_crosswalk</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> 
              <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> 
              <span class="n">merge_how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_crosswalk</span><span class="o">=</span><span class="n">use_crosswalk</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-1.5-)-Get-CSA-and-Geometry-with-a-Crosswalk.">Example 1.5 ) Get CSA and Geometry with a Crosswalk.<a class="anchor-link" href="#Example-1.5-)-Get-CSA-and-Geometry-with-a-Crosswalk."> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Primary Table</span>
<span class="c1"># Description: I created a public dataset from a google xlsx sheet &#39;Bank Addresses and Census Tract&#39; from a workbook of the same name.</span>
<span class="c1"># Table: FDIC Baltimore Banks</span>
<span class="c1"># Columns: Bank Name, Address(es), Census Tract</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vSHFrRSHva1f82ZQ7Uxwf3A1phqljj1oa2duGlZDM1vLtrm1GI5yHmpVX2ilTfMHQ/pub?gid=601362340&amp;single=true&amp;output=csv&#39;</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;Census Tract&#39;</span>

<span class="c1"># Alternate Primary Table</span>
<span class="c1"># Description: Same workbook, different Sheet: &#39;Branches per tract&#39; </span>
<span class="c1"># Columns: Census Tract, Number branches per tract</span>
<span class="c1"># left_ds = &#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vSHFrRSHva1f82ZQ7Uxwf3A1phqljj1oa2duGlZDM1vLtrm1GI5yHmpVX2ilTfMHQ/pub?gid=1698745725&amp;single=true&amp;output=csv&#39;</span>
<span class="c1"># lef_col = &#39;Number branches per tract&#39;</span>

<span class="c1"># Crosswalk Table</span>
<span class="c1"># Table: Crosswalk Census Communities</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">crosswalk_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span>
<span class="n">use_crosswalk</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="s1">&#39;TRACT2010&#39;</span>
<span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID2010&#39;</span>

<span class="c1"># Secondary Table</span>
<span class="c1"># Table: Baltimore Boundaries</span>
<span class="c1"># &#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA&#39;, &#39;NAME10&#39;, &#39;Tract&#39;, &#39;geometry&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vTPKW6YOHPFvkw3FM3m5y67-Aa5ZlrM0Ee1Fb57wlGuldr99sEvVWnkej30FXhSb3j8o9gr8izq2ZRP/pub?output=csv&#39;</span>
<span class="n">right_col</span> <span class="o">=</span><span class="s1">&#39;GEOID10&#39;</span>

<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;geometry&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> 
              <span class="n">use_crosswalk</span><span class="o">=</span><span class="n">use_crosswalk</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="o">=</span><span class="n">crosswalk_ds</span><span class="p">,</span>
              <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="n">crosswalk_right_col</span><span class="p">,</span>
              <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> 
              <span class="n">merge_how</span><span class="o">=</span><span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="n">interactive</span> <span class="p">)</span>

<span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 Handling Left Dataset
Left Dataset and Columns are Valid

 Handling Right Dataset
Right Dataset and Columns are Valid

 Checking the merge_how Parameter
merge_how operator is Valid outer

 Checking the Crosswalk Parameter

 Handling Crosswalk Left Dataset Loading

 Handling Crosswalk Right Dataset Loading

 Assessment Completed

 Ensuring Left-&gt;Crosswalk compatability
Converting Local Key from float64 to Int

 Ensuring Crosswalk-&gt;Right compatability
PERFORMING MERGE LEFT-&gt;CROSSWALK
left_on TRACT2010 right_on GEOID2010 how outer

 Local Column Values Not Matched 
[-1321321321321325            400100            401101            401102
            401507            403401            403500            403803
            411306            411406            411408            420100
            420301            420701            420800            430800
            430900            440100            440200            440702
            441101            450300            452000            490601
            490602            491100            491201            491600
            492300            750101]
43

 Crosswalk Unique Column Values
[ 10100  10200  10300  10400  10500  20100  20200  20300  30100  30200
  40100  40200  60100  60200  60300  60400  70100  70200  70300  70400
  80101  80102  80200  80301  80302  80400  80500  80600  80700  80800
  90100  90200  90300  90400  90500  90600  90700  90800  90900 100100
 100200 100300 110100 110200 120100 120201 120202 120300 120400 120500
 120600 120700 130100 130200 130300 130400 130600 130700 130803 130804
 130805 130806 140100 140200 140300 150100 150200 150300 150400 150500
 150600 150701 150702 150800 150900 151000 151100 151200 151300 160100
 160200 160300 160400 160500 160600 160700 160801 160802 170100 170200
 170300 180100 180200 180300 190100 190200 190300 200100 200200 200300
 200400 200500 200600 200701 200702 200800 210100 210200 220100 230100
 230200 230300 240100 240200 240300 240400 250101 250102 250103 250203
 250204 250205 250206 250207 250301 250303 250401 250402 250500 250600
 260101 260102 260201 260202 260203 260301 260302 260303 260401 260402
 260403 260404 260501 260604 260605 260700 260800 260900 261000 261100
 270101 270102 270200 270301 270302 270401 270402 270501 270502 270600
 270701 270702 270703 270801 270802 270803 270804 270805 270901 270902
 270903 271001 271002 271101 271102 271200 271300 271400 271501 271503
 271600 271700 271801 271802 271900 272003 272004 272005 272006 272007
 280101 280102 280200 280301 280302 280401 280402 280403 280404 280500
  10000]
PERFORMING MERGE LEFT-&gt;RIGHT
left_col GEOID2010 right_col GEOID10 how outer
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/pandas/core/ops/__init__.py:1115: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  result = method(y)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bank Name</th>
      <th>Address(es)</th>
      <th>Census Tract</th>
      <th>GEOID2010</th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>NAME10</th>
      <th>CSA</th>
      <th>Tract</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arundel Federal ...</td>
      <td>333 E. Patapsco ...</td>
      <td>250401.0</td>
      <td>2.45e+10</td>
      <td>250401</td>
      <td>24510250401</td>
      <td>2504.01</td>
      <td>Brooklyn/Curtis ...</td>
      <td>2504</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3601 S Hanover St</td>
      <td>250401.0</td>
      <td>2.45e+10</td>
      <td>250401</td>
      <td>24510250401</td>
      <td>2504.01</td>
      <td>Brooklyn/Curtis ...</td>
      <td>2504</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bank of America,...</td>
      <td>20 N Howard St</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>100 S Charles St...</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Branch Banking a...</td>
      <td>2 N CHARLES ST</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we can save the data so that it may be used in later tutorials.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;test_save_data_with_geom_and_csa&#39;</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">string</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Download data by:</p>
<ul>
<li>Clicking the 'Files' tab in the left hand menu of this screen. Locate your file within the file explorer that appears directly under the 'Files' tab button once clicked. Right click the file in the file explorer and select the 'download' option from the dropdown.  </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the next tutorial you will learn how to load this data as a geospatial dataset so that it may be mapped and mapping functionalities may be applied to it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can upload this data into the next tutorial in one of two ways.</p>
<p>1)</p>
<ul>
<li>uploading the saved file to google Drive and connecting to your drive path</li>
</ul>
<p>OR.</p>
<p>2)</p>
<ul>
<li>'by first downloading the dataset as directed above, and then navigating to the next tutorial. Go to their page and:</li>
<li>Uploading data using an file 'upload' button accessible within the 'Files' tab in the left hand menu of this screen. The next tutorial will teach you how to load this data so that it may be mapped.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Example-2">Interactive Example 2<a class="anchor-link" href="#Interactive-Example-2"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># When the prompts come up input the values not included from Interactive Example 1 and you will get the same output.</span>
<span class="c1"># This is to demonstrate that not all parameters must be known prior to executing the function.</span>

<span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergedDataset</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">use_crosswalk</span><span class="o">=</span><span class="n">use_crosswalk</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> <span class="n">merge_how</span> <span class="o">=</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="n">interactive</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergedDataset</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Run-Alone">Interactive Run Alone<a class="anchor-link" href="#Interactive-Run-Alone"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergeDatasets</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Preconfigured-Example-1">Preconfigured Example 1<a class="anchor-link" href="#Preconfigured-Example-1"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Census Crosswalk</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span>

<span class="c1"># Baltimore Boundaries</span>
<span class="c1"># &#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA&#39;, &#39;NAME10&#39;, &#39;Tract&#39;, &#39;geometry&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vTPKW6YOHPFvkw3FM3m5y67-Aa5ZlrM0Ee1Fb57wlGuldr99sEvVWnkej30FXhSb3j8o9gr8izq2ZRP/pub?output=csv&#39;</span>
<span class="c1"># The Left DS Cols will map to the first three Right DS Cols listed</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID2010&#39;</span>
<span class="n">right_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID10&#39;</span>
<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> <span class="n">merge_how</span> <span class="o">=</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="n">interactive</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
</div>
 

