from getml.datasets import (
        make_numerical,
        make_categorical,
        make_discrete,
        make_same_units_categorical,
        make_same_units_numerical,
        make_snowflake
)

from getml import engine

# --------------------------------------------------------------------

def test_make_numerical():
    
    expected_population = "[['0' -0.9064500983732602 1.0 Timestamp('1970-01-01 07:06:34.496208')]\n ['1' 0.6598001791722166 2.0 Timestamp('1970-01-01 12:23:07.885363200')]\n ['2' 0.5768922528549834 0.0 Timestamp('1970-01-01 05:12:45.450057600')]\n ['3' -0.7871314796686713 1.0 Timestamp('1970-01-01 22:53:23.296531200')]\n ['4' -0.6901481157093159 3.0 Timestamp('1970-01-01 23:22:02.103484800')]\n ['5' -0.30621270384341237 2.0 Timestamp('1970-01-01 10:47:53.976624')]\n ['6' -0.6995294139978356 0.0 Timestamp('1970-01-01 01:08:22.548307200')]\n ['7' -0.5062768388662606 0.0 Timestamp('1970-01-01 19:07:36.958828800')]\n ['8' -0.16646294639332537 3.0 Timestamp('1970-01-01 15:30:37.359676800')]\n ['9' 0.44448876846862495 3.0 Timestamp('1970-01-01 23:01:09.363100800')]]"
    expected_peripheral = "[['6' -0.698031967092388 Timestamp('1970-01-01 04:44:40.853529600')]\n ['9' 0.7143269641032541 Timestamp('1970-01-01 15:44:23.134934400')]\n ['6' -0.17800333162538906 Timestamp('1970-01-01 14:10:36.993475200')]\n ['5' -0.7759030148340138 Timestamp('1970-01-01 06:58:03.806025599')]\n ['3' 0.20326030857703214 Timestamp('1970-01-01 14:13:30.735580800')]\n ['5' 0.3013189279533053 Timestamp('1970-01-01 11:00:53.750275200')]\n ['2' -0.7134085414062035 Timestamp('1970-01-01 10:18:43.964064')]\n ['4' -0.8123046890119909 Timestamp('1970-01-01 02:14:52.519142400')]\n ['6' 0.1132346100517212 Timestamp('1970-01-01 01:13:00.582902400')]\n ['0' 0.0423903321517749 Timestamp('1970-01-01 19:41:31.781558400')]\n ['3' -0.2609708691301287 Timestamp('1970-01-01 03:21:46.375430400')]\n ['0' -0.016481608180457075 Timestamp('1970-01-01 03:07:33.179923200')]\n ['4' -0.06506559465982309 Timestamp('1970-01-01 16:57:47.098195200')]\n ['0' 0.1985687069756361 Timestamp('1970-01-01 15:35:57.603177600')]\n ['5' -0.054909091149619504 Timestamp('1970-01-01 12:36:26.661744')]\n ['2' 0.0227513871273759 Timestamp('1970-01-01 13:35:53.845238400')]\n ['8' 0.9950204180009785 Timestamp('1970-01-01 13:09:29.767161599')]\n ['4' -0.08613913247356986 Timestamp('1970-01-01 22:35:48.233472')]\n ['6' 0.8567966523203527 Timestamp('1970-01-01 21:45:46.288368')]\n ['1' -0.8929308169019912 Timestamp('1970-01-01 18:42:20.062886400')]\n ['7' 0.40522553191374655 Timestamp('1970-01-01 23:39:44.517974400')]\n ['6' 0.6503737233129518 Timestamp('1970-01-01 23:43:00.724252800')]\n ['4' -0.6757844336805854 Timestamp('1970-01-01 22:33:13.813084800')]\n ['5' -0.49389627752500975 Timestamp('1970-01-01 07:48:48.805632')]\n ['1' -0.7428146156893436 Timestamp('1970-01-01 03:42:52.087305600')]\n ['7' 0.07505159840420395 Timestamp('1970-01-01 23:16:48.939686400')]\n ['5' 0.1872681596055652 Timestamp('1970-01-01 23:15:31.489171200')]\n ['2' -0.6498856871734209 Timestamp('1970-01-01 12:25:04.243612799')]\n ['9' 0.6276397406049137 Timestamp('1970-01-01 21:31:18.845500800')]\n ['9' 0.8487866410262443 Timestamp('1970-01-01 11:54:38.379888')]\n ['0' 0.44828277705164865 Timestamp('1970-01-01 13:42:12.626640')]\n ['9' 0.23403717684606384 Timestamp('1970-01-01 10:48:29.158444800')]\n ['0' 0.6653639144728869 Timestamp('1970-01-01 15:38:56.768438400')]\n ['8' 0.9592370821928327 Timestamp('1970-01-01 06:03:06.549436800')]\n ['8' 0.5605180135221124 Timestamp('1970-01-01 13:00:39.333888')]\n ['9' 0.16072164259048205 Timestamp('1970-01-01 03:13:08.700585600')]\n ['0' -0.37602210767391897 Timestamp('1970-01-01 11:23:47.075251200')]\n ['1' -0.9237997282731696 Timestamp('1970-01-01 17:15:01.937779200')]\n ['7' 0.0037442665096214522 Timestamp('1970-01-01 20:18:13.260556800')]\n ['1' 0.44090272562634625 Timestamp('1970-01-01 07:00:03.725424')]]"
    
    # ----------------------------------------------------------------
    
    engine.set_project('test-datasets')
    
    # ----------------------------------------------------------------
    
    population, peripheral = make_numerical(
            n_rows_population=10,
            n_rows_peripheral=40,
            random_state=2309)

    # ----------------------------------------------------------------
    
    assert population.n_rows() == 10
    assert population.n_cols() == 4
    assert population.n_bytes() == 280
    assert str(peripheral.to_pandas().values) == expected_peripheral
    assert str(population.to_pandas().values) == expected_population
    
    # ----------------------------------------------------------------
    
    engine.delete_project('test-datasets')

# --------------------------------------------------------------------

def test_make_categorical():
    
    expected_population = "[['4' '0' 4.0 Timestamp('1970-01-01 16:36:30.490070399')]\n ['3' '1' 4.0 Timestamp('1970-01-01 11:22:48.651312')]\n ['5' '2' 0.0 Timestamp('1970-01-01 18:28:00.570720')]\n ['9' '3' 0.0 Timestamp('1970-01-01 07:30:16.282080')]\n ['2' '4' 3.0 Timestamp('1970-01-01 20:21:11.747404800')]\n ['0' '5' 4.0 Timestamp('1970-01-01 20:05:15.628329600')]\n ['3' '6' 0.0 Timestamp('1970-01-01 00:05:19.411123200')]\n ['5' '7' 1.0 Timestamp('1970-01-01 05:34:58.157529600')]\n ['9' '8' 0.0 Timestamp('1970-01-01 00:02:41.952480')]\n ['7' '9' 3.0 Timestamp('1970-01-01 15:39:42.455635200')]]"
    expected_peripheral = "[['0' '5' Timestamp('1970-01-01 01:13:00.582902400')]\n ['3' '0' Timestamp('1970-01-01 19:41:31.781558400')]\n ['6' '0' Timestamp('1970-01-01 03:21:46.375430400')]\n ['8' '6' Timestamp('1970-01-01 03:07:33.179923200')]\n ['0' '9' Timestamp('1970-01-01 16:57:47.098195200')]\n ['9' '6' Timestamp('1970-01-01 15:35:57.603177600')]\n ['2' '5' Timestamp('1970-01-01 12:36:26.661744')]\n ['4' '3' Timestamp('1970-01-01 13:35:53.845238400')]\n ['7' '5' Timestamp('1970-01-01 13:09:29.767161599')]\n ['9' '2' Timestamp('1970-01-01 22:35:48.233472')]\n ['6' '4' Timestamp('1970-01-01 21:45:46.288368')]\n ['9' '6' Timestamp('1970-01-01 18:42:20.062886400')]\n ['0' '0' Timestamp('1970-01-01 23:39:44.517974400')]\n ['5' '3' Timestamp('1970-01-01 23:43:00.724252800')]\n ['9' '0' Timestamp('1970-01-01 22:33:13.813084800')]\n ['4' '4' Timestamp('1970-01-01 07:48:48.805632')]\n ['5' '0' Timestamp('1970-01-01 03:42:52.087305600')]\n ['4' '5' Timestamp('1970-01-01 23:16:48.939686400')]\n ['8' '2' Timestamp('1970-01-01 23:15:31.489171200')]\n ['2' '8' Timestamp('1970-01-01 12:25:04.243612799')]\n ['3' '4' Timestamp('1970-01-01 21:31:18.845500800')]\n ['4' '6' Timestamp('1970-01-01 11:54:38.379888')]\n ['2' '1' Timestamp('1970-01-01 13:42:12.626640')]\n ['1' '7' Timestamp('1970-01-01 10:48:29.158444800')]\n ['9' '6' Timestamp('1970-01-01 15:38:56.768438400')]\n ['0' '4' Timestamp('1970-01-01 06:03:06.549436800')]\n ['8' '5' Timestamp('1970-01-01 13:00:39.333888')]\n ['8' '1' Timestamp('1970-01-01 03:13:08.700585600')]\n ['4' '7' Timestamp('1970-01-01 11:23:47.075251200')]\n ['4' '5' Timestamp('1970-01-01 17:15:01.937779200')]\n ['7' '2' Timestamp('1970-01-01 20:18:13.260556800')]\n ['4' '9' Timestamp('1970-01-01 07:00:03.725424')]\n ['1' '9' Timestamp('1970-01-01 09:45:48.115814399')]\n ['9' '0' Timestamp('1970-01-01 22:48:28.794355200')]\n ['0' '9' Timestamp('1970-01-01 09:49:29.306294400')]\n ['0' '0' Timestamp('1970-01-01 22:22:38.464896')]\n ['2' '8' Timestamp('1970-01-01 22:46:31.566144')]\n ['5' '8' Timestamp('1970-01-01 13:17:25.327535999')]\n ['6' '9' Timestamp('1970-01-01 00:08:27.501244800')]\n ['7' '0' Timestamp('1970-01-01 13:28:41.575843200')]\n ['8' '1' Timestamp('1970-01-01 07:23:44.401747200')]\n ['8' '7' Timestamp('1970-01-01 00:09:59.676739200')]\n ['5' '1' Timestamp('1970-01-01 02:57:09.357062400')]\n ['6' '1' Timestamp('1970-01-01 09:58:34.092076800')]\n ['0' '0' Timestamp('1970-01-01 11:11:14.811273600')]\n ['2' '7' Timestamp('1970-01-01 03:36:01.443916800')]\n ['1' '3' Timestamp('1970-01-01 11:10:12.695462400')]\n ['9' '6' Timestamp('1970-01-01 04:47:45.580790400')]\n ['1' '0' Timestamp('1970-01-01 20:11:42.488649600')]\n ['0' '4' Timestamp('1970-01-01 06:53:33.243561600')]]"
    
    # ----------------------------------------------------------------
    
    engine.set_project('test-datasets')
    
    # ----------------------------------------------------------------

    population, peripheral = make_categorical(
            n_rows_population=10,
            n_rows_peripheral=50,
            random_state=2309)

    # ----------------------------------------------------------------
    
    assert population.n_rows() == 10
    assert population.n_cols() == 4
    assert population.n_bytes() == 240
    assert str(peripheral.to_pandas().values) == expected_peripheral
    assert str(population.to_pandas().values) == expected_population
    
    # ----------------------------------------------------------------
    
    engine.delete_project('test-datasets')

# --------------------------------------------------------------------

def test_make_discrete():
    
    # ----------------------------------------------------------------
    
    engine.set_project('test-datasets')
    
    # ----------------------------------------------------------------

    population, peripheral = make_discrete(
            n_rows_population=10,
            n_rows_peripheral=50,
            random_state=2309)

    # ----------------------------------------------------------------
    
    assert population.n_rows() == 10
    assert population.n_cols() == 4
    assert population.n_bytes() == 280
    
    # ----------------------------------------------------------------
    
    engine.delete_project('test-datasets')
    
# --------------------------------------------------------------------

def test_make_same_units_categorical():
    
    expected_population = "[['0' '0' 0.0 Timestamp('1970-01-01 07:06:34.496208')]\n ['8' '1' 0.0 Timestamp('1970-01-01 12:23:07.885363200')]\n ['7' '2' 0.0 Timestamp('1970-01-01 05:12:45.450057600')]\n ['1' '3' 0.0 Timestamp('1970-01-01 22:53:23.296531200')]\n ['1' '4' 2.0 Timestamp('1970-01-01 23:22:02.103484800')]\n ['3' '5' 0.0 Timestamp('1970-01-01 10:47:53.976624')]\n ['1' '6' 0.0 Timestamp('1970-01-01 01:08:22.548307200')]\n ['2' '7' 0.0 Timestamp('1970-01-01 19:07:36.958828800')]\n ['4' '8' 1.0 Timestamp('1970-01-01 15:30:37.359676800')]\n ['7' '9' 0.0 Timestamp('1970-01-01 23:01:09.363100800')]]"
    expected_peripheral = "[['1' '4' 0.2856452707039745 Timestamp('1970-01-01 06:44:27.252931200')]\n ['8' '6' -0.6151800014362641 Timestamp('1970-01-01 14:15:44.166038400')]\n ['4' '2' 0.2905034404722113 Timestamp('1970-01-01 10:29:35.307312')]\n ['1' '5' 0.6671230175829661 Timestamp('1970-01-01 19:24:11.743977600')]\n ['6' '1' 0.21439653642640488 Timestamp('1970-01-01 22:21:11.276409600')]\n ['6' '4' -0.9096800577206534 Timestamp('1970-01-01 10:43:47.109964800')]\n ['1' '7' 0.028757996843454592 Timestamp('1970-01-01 12:26:34.191628799')]\n ['0' '8' -0.7157119457091028 Timestamp('1970-01-01 05:17:29.220316800')]\n ['5' '2' 0.3570823158608316 Timestamp('1970-01-01 11:02:01.744742400')]\n ['5' '4' 0.07155427610567933 Timestamp('1970-01-01 10:00:49.852396800')]\n ['3' '9' 0.7769934186068002 Timestamp('1970-01-01 08:46:50.875017600')]\n ['4' '4' 0.905217959143445 Timestamp('1970-01-01 20:42:16.781126400')]\n ['4' '9' 0.8605460151063216 Timestamp('1970-01-01 11:47:39.953846400')]\n ['5' '9' 0.7936814338248306 Timestamp('1970-01-01 15:21:46.670054400')]\n ['4' '5' -0.8748659207158465 Timestamp('1970-01-01 06:47:42.621475199')]\n ['5' '0' -0.44522871184477686 Timestamp('1970-01-01 10:45:16.530854400')]\n ['9' '5' 0.1661434292638826 Timestamp('1970-01-01 02:55:53.049360')]\n ['4' '3' 0.774893785534704 Timestamp('1970-01-01 17:49:11.310873600')]\n ['9' '0' 0.6598009700653098 Timestamp('1970-01-01 07:12:19.913385600')]\n ['0' '1' -0.6046098721650202 Timestamp('1970-01-01 08:03:29.839478400')]\n ['7' '4' 0.3116466419737096 Timestamp('1970-01-01 03:17:54.984220800')]\n ['8' '4' 0.18141188604696112 Timestamp('1970-01-01 07:08:56.536512')]\n ['1' '1' -0.419356341900033 Timestamp('1970-01-01 14:20:42.942854400')]\n ['2' '4' 0.1854336931840852 Timestamp('1970-01-01 13:10:07.931683200')]\n ['1' '1' -0.08208911357992621 Timestamp('1970-01-01 15:33:22.032719999')]\n ['5' '8' -0.14064897963095846 Timestamp('1970-01-01 00:24:51.442243200')]\n ['5' '2' -0.8126731682508164 Timestamp('1970-01-01 15:54:02.404944')]\n ['1' '4' -0.898597617895383 Timestamp('1970-01-01 05:51:06.706972800')]\n ['8' '0' 0.641013462637442 Timestamp('1970-01-01 00:03:23.973379200')]\n ['9' '2' -0.7197598282620734 Timestamp('1970-01-01 15:28:01.873804800')]\n ['7' '0' -0.7395097242351707 Timestamp('1970-01-01 23:47:54.619728')]\n ['6' '4' 0.41359023605053236 Timestamp('1970-01-01 08:08:39.672297600')]\n ['8' '9' 0.2999445178844704 Timestamp('1970-01-01 03:03:49.408502400')]\n ['9' '9' 0.05061716956024065 Timestamp('1970-01-01 20:27:49.473561600')]\n ['7' '8' 0.13319086294518723 Timestamp('1970-01-01 20:18:55.760025600')]\n ['5' '8' 0.09652238810105995 Timestamp('1970-01-01 17:41:30.917241600')]\n ['3' '3' 0.8830609601698234 Timestamp('1970-01-01 09:46:52.548873600')]\n ['0' '5' 0.8135714905002533 Timestamp('1970-01-01 15:45:05.519232')]\n ['5' '2' 0.5587977522226819 Timestamp('1970-01-01 19:10:26.883350400')]\n ['7' '4' 0.9718638416090439 Timestamp('1970-01-01 12:00:52.525756799')]\n ['9' '7' 0.9764056542719644 Timestamp('1970-01-01 16:42:33.899529600')]\n ['3' '3' 0.879486413470959 Timestamp('1970-01-01 14:57:28.391068800')]\n ['3' '4' -0.34887023935783645 Timestamp('1970-01-01 14:52:20.240803200')]\n ['3' '1' -0.6904609424992252 Timestamp('1970-01-01 03:20:35.685110400')]\n ['4' '8' 0.9400217514588045 Timestamp('1970-01-01 12:41:45.664281600')]\n ['8' '1' 0.9382289150756085 Timestamp('1970-01-01 21:11:30.064012800')]\n ['7' '5' 0.034820454954926916 Timestamp('1970-01-01 21:10:24.099600')]\n ['7' '5' 0.7934917938673376 Timestamp('1970-01-01 15:50:21.784185600')]\n ['0' '5' -0.007444909308618186 Timestamp('1970-01-01 07:50:11.348304')]\n ['5' '0' 0.1419589506732577 Timestamp('1970-01-01 18:40:18.743894400')]]"
    
    # ----------------------------------------------------------------
    
    engine.set_project('test-datasets')
    
    # ----------------------------------------------------------------

    population, peripheral = make_same_units_categorical(
            n_rows_population=10,
            n_rows_peripheral=50,
            random_state=2309)

    # ----------------------------------------------------------------
    
    assert population.n_rows() == 10
    assert population.n_cols() == 4
    assert population.n_bytes() == 240
    assert str(peripheral.to_pandas().values) == expected_peripheral
    assert str(population.to_pandas().values) == expected_population
    
    # ----------------------------------------------------------------
    
    engine.delete_project('test-datasets')

# --------------------------------------------------------------------

def test_make_same_units_numerical():
    
    expected_population = "[['0' -0.9064500983732602 1.0 Timestamp('1970-01-01 07:06:34.496208')]\n ['1' 0.6598001791722166 2.0 Timestamp('1970-01-01 12:23:07.885363200')]\n ['2' 0.5768922528549834 0.0 Timestamp('1970-01-01 05:12:45.450057600')]\n ['3' -0.7871314796686713 1.0 Timestamp('1970-01-01 22:53:23.296531200')]\n ['4' -0.6901481157093159 3.0 Timestamp('1970-01-01 23:22:02.103484800')]\n ['5' -0.30621270384341237 2.0 Timestamp('1970-01-01 10:47:53.976624')]\n ['6' -0.6995294139978356 0.0 Timestamp('1970-01-01 01:08:22.548307200')]\n ['7' -0.5062768388662606 2.0 Timestamp('1970-01-01 19:07:36.958828800')]\n ['8' -0.16646294639332537 4.0 Timestamp('1970-01-01 15:30:37.359676800')]\n ['9' 0.44448876846862495 4.0 Timestamp('1970-01-01 23:01:09.363100800')]]"
    expected_peripheral = "[['6' -0.698031967092388 Timestamp('1970-01-01 10:48:29.158444800')]\n ['1' 0.7143269641032541 Timestamp('1970-01-01 15:38:56.768438400')]\n ['6' -0.17800333162538906 Timestamp('1970-01-01 06:03:06.549436800')]\n ['8' -0.7759030148340138 Timestamp('1970-01-01 13:00:39.333888')]\n ['6' 0.20326030857703214 Timestamp('1970-01-01 03:13:08.700585600')]\n ['0' 0.3013189279533053 Timestamp('1970-01-01 11:23:47.075251200')]\n ['5' -0.7134085414062035 Timestamp('1970-01-01 17:15:01.937779200')]\n ['1' -0.8123046890119909 Timestamp('1970-01-01 20:18:13.260556800')]\n ['6' 0.1132346100517212 Timestamp('1970-01-01 07:00:03.725424')]\n ['5' 0.0423903321517749 Timestamp('1970-01-01 09:45:48.115814399')]\n ['8' -0.2609708691301287 Timestamp('1970-01-01 22:48:28.794355200')]\n ['9' -0.016481608180457075 Timestamp('1970-01-01 09:49:29.306294400')]\n ['9' -0.06506559465982309 Timestamp('1970-01-01 22:22:38.464896')]\n ['8' 0.1985687069756361 Timestamp('1970-01-01 22:46:31.566144')]\n ['0' -0.054909091149619504 Timestamp('1970-01-01 13:17:25.327535999')]\n ['2' 0.0227513871273759 Timestamp('1970-01-01 00:08:27.501244800')]\n ['5' 0.9950204180009785 Timestamp('1970-01-01 13:28:41.575843200')]\n ['8' -0.08613913247356986 Timestamp('1970-01-01 07:23:44.401747200')]\n ['8' 0.8567966523203527 Timestamp('1970-01-01 00:09:59.676739200')]\n ['1' -0.8929308169019912 Timestamp('1970-01-01 02:57:09.357062400')]\n ['6' 0.40522553191374655 Timestamp('1970-01-01 09:58:34.092076800')]\n ['5' 0.6503737233129518 Timestamp('1970-01-01 11:11:14.811273600')]\n ['2' -0.6757844336805854 Timestamp('1970-01-01 03:36:01.443916800')]\n ['5' -0.49389627752500975 Timestamp('1970-01-01 11:10:12.695462400')]\n ['4' -0.7428146156893436 Timestamp('1970-01-01 04:47:45.580790400')]\n ['4' 0.07505159840420395 Timestamp('1970-01-01 20:11:42.488649600')]\n ['0' 0.1872681596055652 Timestamp('1970-01-01 06:53:33.243561600')]\n ['0' -0.6498856871734209 Timestamp('1970-01-01 10:27:56.616480')]\n ['8' 0.6276397406049137 Timestamp('1970-01-01 00:16:29.895945600')]\n ['1' 0.8487866410262443 Timestamp('1970-01-01 05:57:39.153139200')]\n ['1' 0.44828277705164865 Timestamp('1970-01-01 02:17:33.669830400')]\n ['7' 0.23403717684606384 Timestamp('1970-01-01 11:56:33.040636800')]\n ['6' 0.6653639144728869 Timestamp('1970-01-01 21:46:38.896723200')]\n ['5' 0.9592370821928327 Timestamp('1970-01-01 23:34:51.750537600')]\n ['5' 0.5605180135221124 Timestamp('1970-01-01 19:46:04.746806400')]\n ['5' 0.16072164259048205 Timestamp('1970-01-01 20:49:55.633555200')]\n ['9' -0.37602210767391897 Timestamp('1970-01-01 08:33:39.751257600')]\n ['9' -0.9237997282731696 Timestamp('1970-01-01 12:56:14.638502400')]\n ['7' 0.0037442665096214522 Timestamp('1970-01-01 05:14:26.900246400')]\n ['9' 0.44090272562634625 Timestamp('1970-01-01 10:31:50.687990400')]\n ['9' 0.8074536372782282 Timestamp('1970-01-01 18:49:12.874656')]\n ['9' -0.3110079706190767 Timestamp('1970-01-01 07:14:02.381539199')]\n ['3' -0.3458575819992322 Timestamp('1970-01-01 10:12:14.508979200')]\n ['1' -0.31928959049275796 Timestamp('1970-01-01 03:22:27.744441600')]\n ['9' -0.09068519067660796 Timestamp('1970-01-01 20:14:57.364800')]\n ['9' 0.6990157583889574 Timestamp('1970-01-01 03:21:10.095206400')]\n ['5' 0.5823296780427847 Timestamp('1970-01-01 14:11:06.317030400')]\n ['8' 0.46272057574172587 Timestamp('1970-01-01 13:24:33.534230400')]\n ['4' -0.8463685414061115 Timestamp('1970-01-01 13:00:18.891388800')]\n ['5' 0.10328318353002541 Timestamp('1970-01-01 00:30:13.018377600')]]"
    
    # ----------------------------------------------------------------
    
    engine.set_project('test-datasets')
    
    # ----------------------------------------------------------------

    population, peripheral = make_same_units_numerical(
            n_rows_population=10,
            n_rows_peripheral=50,
            random_state=2309)

    # ----------------------------------------------------------------
    
    assert population.n_rows() == 10
    assert population.n_cols() == 4
    assert population.n_bytes() == 280
    assert str(peripheral.to_pandas().values) == expected_peripheral
    assert str(population.to_pandas().values) == expected_population
    
    # ----------------------------------------------------------------
    
    engine.delete_project('test-datasets')

# --------------------------------------------------------------------

def test_make_snowflake():
    
    expected_population = "[['0' -0.9064500983732602 4.0 Timestamp('1970-01-01 07:06:34.496208')]\n ['1' 0.6598001791722166 1.0 Timestamp('1970-01-01 12:23:07.885363200')]\n ['2' 0.5768922528549834 0.0 Timestamp('1970-01-01 05:12:45.450057600')]\n ['3' -0.7871314796686713 0.0 Timestamp('1970-01-01 22:53:23.296531200')]\n ['4' -0.6901481157093159 2.0 Timestamp('1970-01-01 23:22:02.103484800')]\n ['5' -0.30621270384341237 0.0 Timestamp('1970-01-01 10:47:53.976624')]\n ['6' -0.6995294139978356 0.0 Timestamp('1970-01-01 01:08:22.548307200')]\n ['7' -0.5062768388662606 0.0 Timestamp('1970-01-01 19:07:36.958828800')]\n ['8' -0.16646294639332537 2.0 Timestamp('1970-01-01 15:30:37.359676800')]\n ['9' 0.44448876846862495 5.0 Timestamp('1970-01-01 23:01:09.363100800')]]"
    expected_peripheral = "[['6' '0' -0.698031967092388 Timestamp('1970-01-01 10:48:29.158444800')]\n ['1' '1' 0.7143269641032541 Timestamp('1970-01-01 15:38:56.768438400')]\n ['6' '2' -0.17800333162538906 Timestamp('1970-01-01 06:03:06.549436800')]\n ['8' '3' -0.7759030148340138 Timestamp('1970-01-01 13:00:39.333888')]\n ['6' '4' 0.20326030857703214 Timestamp('1970-01-01 03:13:08.700585600')]\n ['0' '5' 0.3013189279533053 Timestamp('1970-01-01 11:23:47.075251200')]\n ['5' '6' -0.7134085414062035 Timestamp('1970-01-01 17:15:01.937779200')]\n ['1' '7' -0.8123046890119909 Timestamp('1970-01-01 20:18:13.260556800')]\n ['6' '8' 0.1132346100517212 Timestamp('1970-01-01 07:00:03.725424')]\n ['5' '9' 0.0423903321517749 Timestamp('1970-01-01 09:45:48.115814399')]\n ['8' '10' -0.2609708691301287 Timestamp('1970-01-01 22:48:28.794355200')]\n ['9' '11' -0.016481608180457075\n  Timestamp('1970-01-01 09:49:29.306294400')]\n ['9' '12' -0.06506559465982309 Timestamp('1970-01-01 22:22:38.464896')]\n ['8' '13' 0.1985687069756361 Timestamp('1970-01-01 22:46:31.566144')]\n ['0' '14' -0.054909091149619504\n  Timestamp('1970-01-01 13:17:25.327535999')]\n ['2' '15' 0.0227513871273759 Timestamp('1970-01-01 00:08:27.501244800')]\n ['5' '16' 0.9950204180009785 Timestamp('1970-01-01 13:28:41.575843200')]\n ['8' '17' -0.08613913247356986\n  Timestamp('1970-01-01 07:23:44.401747200')]\n ['8' '18' 0.8567966523203527 Timestamp('1970-01-01 00:09:59.676739200')]\n ['1' '19' -0.8929308169019912 Timestamp('1970-01-01 02:57:09.357062400')]\n ['6' '20' 0.40522553191374655 Timestamp('1970-01-01 09:58:34.092076800')]\n ['5' '21' 0.6503737233129518 Timestamp('1970-01-01 11:11:14.811273600')]\n ['2' '22' -0.6757844336805854 Timestamp('1970-01-01 03:36:01.443916800')]\n ['5' '23' -0.49389627752500975\n  Timestamp('1970-01-01 11:10:12.695462400')]\n ['4' '24' -0.7428146156893436 Timestamp('1970-01-01 04:47:45.580790400')]\n ['4' '25' 0.07505159840420395 Timestamp('1970-01-01 20:11:42.488649600')]\n ['0' '26' 0.1872681596055652 Timestamp('1970-01-01 06:53:33.243561600')]\n ['0' '27' -0.6498856871734209 Timestamp('1970-01-01 10:27:56.616480')]\n ['8' '28' 0.6276397406049137 Timestamp('1970-01-01 00:16:29.895945600')]\n ['1' '29' 0.8487866410262443 Timestamp('1970-01-01 05:57:39.153139200')]\n ['1' '30' 0.44828277705164865 Timestamp('1970-01-01 02:17:33.669830400')]\n ['7' '31' 0.23403717684606384 Timestamp('1970-01-01 11:56:33.040636800')]\n ['6' '32' 0.6653639144728869 Timestamp('1970-01-01 21:46:38.896723200')]\n ['5' '33' 0.9592370821928327 Timestamp('1970-01-01 23:34:51.750537600')]\n ['5' '34' 0.5605180135221124 Timestamp('1970-01-01 19:46:04.746806400')]\n ['5' '35' 0.16072164259048205 Timestamp('1970-01-01 20:49:55.633555200')]\n ['9' '36' -0.37602210767391897\n  Timestamp('1970-01-01 08:33:39.751257600')]\n ['9' '37' -0.9237997282731696 Timestamp('1970-01-01 12:56:14.638502400')]\n ['7' '38' 0.0037442665096214522\n  Timestamp('1970-01-01 05:14:26.900246400')]\n ['9' '39' 0.44090272562634625 Timestamp('1970-01-01 10:31:50.687990400')]\n ['9' '40' 0.8074536372782282 Timestamp('1970-01-01 18:49:12.874656')]\n ['9' '41' -0.3110079706190767 Timestamp('1970-01-01 07:14:02.381539199')]\n ['3' '42' -0.3458575819992322 Timestamp('1970-01-01 10:12:14.508979200')]\n ['1' '43' -0.31928959049275796\n  Timestamp('1970-01-01 03:22:27.744441600')]\n ['9' '44' -0.09068519067660796 Timestamp('1970-01-01 20:14:57.364800')]\n ['9' '45' 0.6990157583889574 Timestamp('1970-01-01 03:21:10.095206400')]\n ['5' '46' 0.5823296780427847 Timestamp('1970-01-01 14:11:06.317030400')]\n ['8' '47' 0.46272057574172587 Timestamp('1970-01-01 13:24:33.534230400')]\n ['4' '48' -0.8463685414061115 Timestamp('1970-01-01 13:00:18.891388800')]\n ['5' '49' 0.10328318353002541 Timestamp('1970-01-01 00:30:13.018377600')]]"
    expected_peripheral2 = "[['48' -0.43825803351710424 Timestamp('1970-01-01 12:31:01.608614400')]\n ['21' 0.1885223625176664 Timestamp('1970-01-01 16:08:59.753529600')]\n ['30' -0.12557158904590437 Timestamp('1970-01-01 01:16:18.613776')]\n ['6' 0.6169385178453275 Timestamp('1970-01-01 17:16:25.694457600')]\n ['1' 0.8627610276976521 Timestamp('1970-01-01 02:56:25.391212800')]\n ['16' -0.10585393671791543 Timestamp('1970-01-01 17:04:02.076873600')]\n ['4' 0.036902583819282464 Timestamp('1970-01-01 04:00:08.217446400')]\n ['16' -0.5590458263672864 Timestamp('1970-01-01 15:30:15.673881600')]\n ['3' -0.08051516884227672 Timestamp('1970-01-01 10:38:02.385801600')]\n ['12' -0.16551267660254876 Timestamp('1970-01-01 19:34:09.382368')]\n ['29' -0.2682667821394027 Timestamp('1970-01-01 09:33:36.244483200')]\n ['26' 0.7253884513485367 Timestamp('1970-01-01 12:12:02.358172799')]\n ['35' -0.017130698991838278 Timestamp('1970-01-01 05:23:34.392681600')]\n ['37' 0.2802469929205256 Timestamp('1970-01-01 06:08:56.959324800')]\n ['15' -0.43373561327458887 Timestamp('1970-01-01 13:52:31.988064')]\n ['42' -0.10378400859087744 Timestamp('1970-01-01 12:05:09.440044800')]\n ['47' -0.7557164505496936 Timestamp('1970-01-01 09:01:56.781264')]\n ['5' 0.48498404786470406 Timestamp('1970-01-01 18:54:41.488070400')]\n ['13' -0.3995390415507629 Timestamp('1970-01-01 03:31:18.925075200')]\n ['10' -0.3284759383431992 Timestamp('1970-01-01 22:34:23.850652800')]\n ['49' -0.7251161062447424 Timestamp('1970-01-01 17:23:22.432761600')]\n ['26' -0.4042468402971158 Timestamp('1970-01-01 02:35:34.308412800')]\n ['24' 0.19543849106979772 Timestamp('1970-01-01 21:26:28.310380800')]\n ['13' 0.09740582670656828 Timestamp('1970-01-01 12:44:42.475488')]\n ['23' 0.29634334937424867 Timestamp('1970-01-01 21:29:22.264166400')]\n ['25' -0.9654758731600441 Timestamp('1970-01-01 23:29:55.425321600')]\n ['46' 0.32505566910005323 Timestamp('1970-01-01 16:43:38.771328')]\n ['26' -0.5123447455401362 Timestamp('1970-01-01 20:25:15.718713600')]\n ['48' -0.9952783949295825 Timestamp('1970-01-01 09:09:34.347542400')]\n ['35' 0.2889322640384484 Timestamp('1970-01-01 00:34:34.662892800')]\n ['32' 0.9832087899355768 Timestamp('1970-01-01 01:45:28.314345600')]\n ['20' -0.3213038813061948 Timestamp('1970-01-01 18:34:28.618089600')]\n ['7' -0.7446896186206449 Timestamp('1970-01-01 20:37:11.844336')]\n ['26' 0.7053118873221791 Timestamp('1970-01-01 00:27:03.448656')]\n ['5' 0.6929574078814007 Timestamp('1970-01-01 22:31:52.803062400')]\n ['24' 0.4743267871141905 Timestamp('1970-01-01 18:11:27.091593600')]\n ['40' -0.1848947018522895 Timestamp('1970-01-01 04:38:55.208947200')]\n ['16' 0.3126277591817517 Timestamp('1970-01-01 01:45:18.010713600')]\n ['36' 0.5978445229775116 Timestamp('1970-01-01 07:03:56.656713600')]\n ['1' 0.001215873775437748 Timestamp('1970-01-01 20:21:51.083078400')]\n ['21' 0.39245137867701474 Timestamp('1970-01-01 02:45:42.553008')]\n ['26' 0.24649053341901928 Timestamp('1970-01-01 06:38:17.987884800')]\n ['15' 0.23935742652711167 Timestamp('1970-01-01 05:02:54.209673600')]\n ['30' -0.7213961780082232 Timestamp('1970-01-01 15:29:47.336409600')]\n ['26' 0.05800148810899075 Timestamp('1970-01-01 02:22:58.412006400')]\n ['11' 0.7659737039822136 Timestamp('1970-01-01 01:45:29.478153600')]\n ['44' 0.7644467490240971 Timestamp('1970-01-01 11:24:01.284940800')]\n ['26' 0.319948707174585 Timestamp('1970-01-01 22:37:08.493974400')]\n ['21' -0.3469595291607812 Timestamp('1970-01-01 21:45:38.003126400')]\n ['11' 0.5559894425540914 Timestamp('1970-01-01 17:53:42.391823999')]]"
    
    # ----------------------------------------------------------------
    
    engine.set_project('test-datasets')
    
    # ----------------------------------------------------------------

    population, peripheral, peripheral2 = make_snowflake(
            n_rows_population=10,
            n_rows_peripheral1=50,
            n_rows_peripheral2=50,
            random_state=2309)

    # ----------------------------------------------------------------
    
    assert population.n_rows() == 10
    assert population.n_cols() == 4
    assert population.n_bytes() == 280
    assert str(peripheral.to_pandas().values) == expected_peripheral
    assert str(peripheral2.to_pandas().values) == expected_peripheral2
    assert str(population.to_pandas().values) == expected_population
    
    # ----------------------------------------------------------------
    
    engine.delete_project('test-datasets')

