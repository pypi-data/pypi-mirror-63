{"version":3,"sources":["Upload.jsx","TagsInput.jsx","ImageAddForm.jsx","FormModalButton.jsx","SearchBar.jsx","FunctionBar.jsx","TagGroup.jsx","TagsAddForm.jsx","config.js","ImageBox.jsx","ImageWall.jsx","utils.js","App.jsx","serviceWorker.js","index.js"],"names":["Upload","props","handleFileChoose","e","file","target","files","console","log","setState","onChange","state","value","nextProps","undefined","this","type","src","URL","createObjectURL","alt","name","style","width","React","Component","TagsInput","handleOptionRemove","k","tags","slice","triggerChange","handleOptionAdd","handleInputChange","i","event","items","map","t","index","key","placeholder","length","className","disabled","onClick","ImageAddForm","form","onSubmit","labelCol","xs","span","sm","wrapperCol","preventDefault","validateFields","err","values","a","error","resetFields","Item","label","getFieldDecorator","rules","required","message","initialValue","offset","htmlType","FormModalButton","buttonItem","title","WrappedForm","useState","visible","setVisible","onCancel","footer","Option","Select","SearchBar","initialKey","onSearch","setKey","Group","compact","onSelect","Search","defaultValue","enterButton","FunctionBar","searchField","onImageAdd","WrappedAddForm","Form","create","confirm","Modal","TagGroup","onTagDelete","overlay","tag","content","onOk","trigger","onContextMenu","stopPropagation","TagsAddForm","config","BACKEND_PREFIX","Meta","Card","ImageBox","metadata","onImageDelete","onTagsAdd","WrappedTagsAddForm","menu","hoverable","cover","description","ImageWall","imageMetaDatas","display","flexWrap","m","get","url","params","urlO","Object","entries","v","searchParams","append","fetch","href","mode","credentials","post","body","method","JSON","stringify","headers","Headers","postForm","formData","FormData","Boolean","window","location","hostname","match","ReactDOM","render","setImageMetaDatas","current","pageSize","total","pagination","setPagination","setSearchField","refresh","page","per_page","resp","status","json","respJSON","data","useEffect","handleImageAdd","image","imageType","split","img_type","success","handleImageDelete","id","handleTagsAdd","imageId","image_id","handleTagDelete","showSizeChanger","pageSizeOptions","onShowSizeChange","size","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.55e8cf15.chunk.js","sourcesContent":["import React from 'react';\r\nimport { Input } from 'antd';\r\n\r\n\r\n/** 自定义完全受控组件，受上级 Form 控制。\r\n * props:\r\n *  value [Object]: Antd Form 下传\r\n *  onChange [Object]: Antd Form 下传\r\n *\r\n * state:\r\n *  file [Object]\r\n */\r\nexport default class Upload extends React.Component {\r\n  static getDerivedStateFromProps(nextProps) {\r\n    console.log('Upload getDerivedStateFromProps: %o', { nextProps });\r\n    // Should be a controlled component.\r\n    if ('value' in nextProps) {\r\n      return {\r\n        file: (nextProps.value || undefined)\r\n      };\r\n    }\r\n    return null;\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      file: this.props.value,\r\n    };\r\n  }\r\n\r\n  handleFileChoose = (e) => {\r\n    const file = e.target.files[0];\r\n    console.log('Upload: recv file: %o', { file });\r\n    this.setState({\r\n      file,\r\n    });\r\n    this.props.onChange(file);\r\n  }\r\n\r\n  render() {\r\n    const { file } = this.state;\r\n\r\n    return (\r\n      <div>\r\n        {file === undefined ? (\r\n          <Input type=\"file\" onChange={this.handleFileChoose} />\r\n        ) : (\r\n          <img\r\n            src={URL.createObjectURL(file)}\r\n            alt={file.name}\r\n            style={{ width: '300px' }}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\nimport {\r\n  Input,\r\n  Button,\r\n  Icon\r\n} from 'antd';\r\n\r\n\r\n/** 自定义完全受控组件，受上级 Form 控制。\r\n * props:\r\n *  value [Object]: Antd Form 下传\r\n *  onChange [Object]: Antd Form 下传\r\n *\r\n * state:\r\n *  tags [Array[String]]\r\n */\r\nexport default class TagsInput extends React.Component {\r\n  static getDerivedStateFromProps(nextProps) {\r\n    console.log('TagsInput getDerivedStateFromProps: %o', { nextProps });\r\n    // Should be a controlled component.\r\n    if ('value' in nextProps) {\r\n      return {\r\n        tags: (nextProps.value || [''])\r\n      };\r\n    }\r\n    return null;\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tags: this.props.value || [''],\r\n    };\r\n  }\r\n\r\n  handleOptionRemove = (k) => {\r\n    const tags = [\r\n      ...this.state.tags.slice(0, k),\r\n      ...this.state.tags.slice(k + 1),\r\n    ];\r\n    this.triggerChange(tags);\r\n  }\r\n\r\n  handleOptionAdd = () => {\r\n    const tags = [\r\n      ...this.state.tags,\r\n      '',\r\n    ]\r\n    this.triggerChange(tags);\r\n  }\r\n\r\n  handleInputChange = (i, event) => {\r\n    const value = event.target.value || '';\r\n    const tags = [...this.state.tags];\r\n    tags[i] = value;\r\n    this.triggerChange(tags);\r\n  }\r\n\r\n  triggerChange = (tags) => {\r\n    this.setState({\r\n      tags\r\n    });\r\n    this.props.onChange(tags);\r\n  }\r\n\r\n  render() {\r\n    const { tags } = this.state;\r\n\r\n    const items = tags.map((t, index) => {\r\n      return (\r\n        <div key={index}>\r\n          <Input\r\n            value={t}\r\n            placeholder=\"Tag\"\r\n            style={{ width: '80%' }}\r\n            onChange={(event) => { this.handleInputChange(index, event) }} />\r\n          {tags.length > 1 ? (\r\n            <Icon\r\n              className=\"dynamic-delete-button\"\r\n              type=\"minus-circle-o\"\r\n              disabled={tags.length === 1}\r\n              onClick={() => this.handleOptionRemove(index)}\r\n            />\r\n          ) : null}\r\n        </div>\r\n      );\r\n    });\r\n\r\n    return (\r\n      <div>\r\n        {items}\r\n        <Button type=\"dashed\" onClick={this.handleOptionAdd}>\r\n          <Icon type=\"plus\" /> Add Select Item\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { Form, Button } from 'antd';\r\n\r\nimport Upload from './Upload.jsx';\r\nimport TagsInput from './TagsInput.jsx';\r\n\r\n\r\n/**\r\n * props:\r\n *   form: Form.create包装自带的form。\r\n *   onSubmit [callback]\r\n */\r\nexport default function ImageAddForm({\r\n  form,\r\n  onSubmit\r\n}) {\r\n  const handleSubmit = e => {\r\n    e.preventDefault();\r\n    form.validateFields(async (err, values) => {\r\n      if (err) {\r\n        console.error(err);\r\n      } else {\r\n          onSubmit(values);\r\n          form.resetFields();\r\n      }\r\n    });\r\n  };\r\n\r\n  const formItemLayout = {\r\n    labelCol: {\r\n      xs: { span: 24 },\r\n      sm: { span: 4 },\r\n    },\r\n    wrapperCol: {\r\n      xs: { span: 24 },\r\n      sm: { span: 16 },\r\n    },\r\n  };\r\n  const formItemLayoutWithOutLabel = {\r\n    wrapperCol: {\r\n      xs: { span: 24, offset: 0 },\r\n      sm: { span: 22, offset: 4 },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <Form {...formItemLayout} onSubmit={handleSubmit}>\r\n      <Form.Item label=\"图片\">\r\n        {form.getFieldDecorator('image', {\r\n          rules: [{ required: true, message: '必须选择一个图片' }]\r\n        })(\r\n          <Upload />\r\n        )}\r\n      </Form.Item>\r\n      <Form.Item label=\"标签\">\r\n        {form.getFieldDecorator('tags', {\r\n          initialValue: [''],\r\n          rules: [{ required: true, message: '必须输入标签' }],\r\n        })(\r\n          <TagsInput />\r\n        )}\r\n      </Form.Item>\r\n      <Form.Item {...formItemLayoutWithOutLabel}>\r\n        <Button type=\"primary\" htmlType=\"submit\">\r\n          提交\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Modal } from 'antd';\r\n\r\n\r\n/**\r\n * props:\r\n *   buttonItem [Object]\r\n *   title [String]: 弹出的 Modal 的 title\r\n *   WrappedForm [Object]\r\n *   onSubmit [callback]\r\n */\r\nexport default function FormModalButton({\r\n  buttonItem,\r\n  title,\r\n  WrappedForm,\r\n  onSubmit,\r\n}) {\r\n  const [visible, setVisible] = useState(false);\r\n\r\n  const showModal = () => {\r\n    setVisible(true);\r\n  };\r\n\r\n  const handleSubmit = (values) => {\r\n    setVisible(false);\r\n    onSubmit(values);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setVisible(false);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <buttonItem.type {...buttonItem.props} onClick={showModal} />\r\n      <Modal\r\n        title={title}\r\n        visible={visible}\r\n        onCancel={handleCancel}\r\n        footer={null}\r\n      >\r\n        <WrappedForm onSubmit={handleSubmit} />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Input, Select } from 'antd';\r\n\r\nconst { Option } = Select;\r\n\r\n\r\n/**\r\n * props:\r\n *   initialKey [String]\r\n *   initialValue [String]\r\n *   onSearch [callback]\r\n *\r\n * state:\r\n *   initialKey [String]\r\n */\r\nexport default function SearchBar({\r\n  initialKey,\r\n  initialValue,\r\n  onSearch,\r\n}) {\r\n  const [ key, setKey ] = useState(initialKey);\r\n\r\n  return (\r\n    <Input.Group compact>\r\n      <Select\r\n        value={key}\r\n        style={{ width: '10%' }}\r\n        onSelect={setKey}\r\n      >\r\n        <Option value=\"tag\">标签</Option>\r\n      </Select>\r\n      <Input.Search\r\n        style={{ width: '50%' }}\r\n        defaultValue={initialValue}\r\n        onSearch={(value) => onSearch(key, value)}\r\n        enterButton\r\n      />\r\n    </Input.Group>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Form, Button, Row, Col } from 'antd';\r\n\r\nimport ImageAddForm from './ImageAddForm.jsx';\r\nimport FormModalButton from './FormModalButton.jsx';\r\nimport SearchBar from './SearchBar.jsx';\r\n\r\n\r\n/**\r\n * props:\r\n *   searchField [Object]: {key: , value: }\r\n *   onImageAdd [callback]\r\n *   onSearch [callback]\r\n */\r\nexport default function FunctionBar({\r\n  searchField,\r\n  onImageAdd,\r\n  onSearch,\r\n}) {\r\n  const WrappedAddForm = Form.create()(ImageAddForm);\r\n\r\n  return (\r\n    <Row>\r\n      <Col span={18}>\r\n        <SearchBar\r\n          initialKey={searchField.key}\r\n          initialValue={searchField.value}\r\n          onSearch={onSearch}\r\n        />\r\n      </Col>\r\n      <Col span={6}>\r\n        <FormModalButton\r\n          buttonItem={(<Button type=\"primary\">添加</Button>)}\r\n          title=\"添加图片\"\r\n          WrappedForm={WrappedAddForm}\r\n          onSubmit={onImageAdd}\r\n        />\r\n      </Col>\r\n    </Row>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport {\r\n  Tag,\r\n  Dropdown,\r\n  Menu,\r\n  Modal\r\n} from 'antd';\r\n\r\nconst { confirm } = Modal;\r\n\r\n/**\r\n * props:\r\n *   tags: [Array[String]]\r\n *   onTagDelete: [callback]\r\n */\r\nexport default function TagGroup({\r\n  tags,\r\n  onTagDelete,\r\n}) {\r\n  const showConfirm = (tag) => {\r\n    confirm({\r\n      title: '确定删除该标签？',\r\n      content: '注意！标签删除后无法恢复！',\r\n      onOk() {\r\n        onTagDelete(tag);\r\n      },\r\n      onCancel() {},\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {tags.map((t) => {\r\n        return (\r\n          <Dropdown\r\n            key={t}\r\n            overlay={\r\n              <Menu>\r\n                <Menu.Item>\r\n                  <div onClick={() => showConfirm(t)}>\r\n                    删除标签\r\n                  </div>\r\n                </Menu.Item>\r\n              </Menu>\r\n            }\r\n            trigger={['contextMenu']}\r\n            onContextMenu={(e) => e.stopPropagation()}\r\n          >\r\n            <Tag className=\"tag\">{t}</Tag>\r\n          </Dropdown>\r\n        )})}\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Form, Button } from 'antd';\r\n\r\nimport TagsInput from './TagsInput.jsx';\r\n\r\n\r\n/**\r\n * props:\r\n *   form: Form.create包装自带的form。\r\n *   onSubmit [callback]\r\n */\r\nexport default function TagsAddForm({\r\n  form,\r\n  onSubmit,\r\n}) {\r\n  const handleSubmit = e => {\r\n    e.preventDefault();\r\n    form.validateFields(async (err, values) => {\r\n      if (err) {\r\n        console.error(err);\r\n      } else {\r\n          onSubmit(values['tags']);\r\n          form.resetFields();\r\n      }\r\n    });\r\n  };\r\n\r\n  const formItemLayout = {\r\n    labelCol: {\r\n      xs: { span: 24 },\r\n      sm: { span: 4 },\r\n    },\r\n    wrapperCol: {\r\n      xs: { span: 24 },\r\n      sm: { span: 16 },\r\n    },\r\n  };\r\n  const formItemLayoutWithOutLabel = {\r\n    wrapperCol: {\r\n      xs: { span: 24, offset: 0 },\r\n      sm: { span: 22, offset: 4 },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <Form {...formItemLayout} onSubmit={handleSubmit}>\r\n      <Form.Item label=\"标签\">\r\n        {form.getFieldDecorator('tags', {\r\n          initialValue: [''],\r\n          rules: [{ required: true, message: '必须输入标签' }],\r\n        })(\r\n          <TagsInput />\r\n        )}\r\n      </Form.Item>\r\n      <Form.Item {...formItemLayoutWithOutLabel}>\r\n        <Button type=\"primary\" htmlType=\"submit\">\r\n          提交\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n}\r\n","const config = {\r\n    BACKEND_PREFIX: 'http://127.0.0.1:5000',\r\n};\r\n\r\nexport default config;\r\n","import React from 'react';\r\nimport {\r\n  Card,\r\n  Dropdown,\r\n  Menu,\r\n  Modal,\r\n  Form,\r\n} from 'antd'\r\n\r\nimport TagGroup from './TagGroup.jsx';\r\nimport TagsAddForm from './TagsAddForm.jsx';\r\nimport config from './config';\r\nimport FormModalButton from './FormModalButton.jsx';\r\n\r\nconst { confirm } = Modal;\r\nconst { BACKEND_PREFIX } = config;\r\nconst { Meta } = Card;\r\n\r\n\r\n/**\r\n * props:\r\n *   metadata [Object]: {\r\n *     \"id\": [Number],\r\n *     \"img_type\": [String],\r\n *     \"tags\": [Array[String]],\r\n *     \"create_at\": [String],\r\n *   }\r\n *   onImageDelete [callback]\r\n *   onTagsAdd [callback]\r\n *   onTagDelete [callback]\r\n */\r\nexport default function ImageBox({\r\n  metadata,\r\n  onImageDelete,\r\n  onTagsAdd,\r\n  onTagDelete,\r\n}){\r\n  const showConfirm = () => {\r\n    confirm({\r\n      title: '确定删除该图片？',\r\n      content: '注意！图片删除后无法恢复！',\r\n      onOk() {\r\n        onImageDelete(metadata['id']);\r\n      },\r\n      onCancel() {},\r\n    });\r\n  }\r\n\r\n  const WrappedTagsAddForm = Form.create()(TagsAddForm);\r\n\r\n  const menu = (\r\n    <Menu>\r\n      <Menu.Item>\r\n        <div onClick={showConfirm}>\r\n          删除图片\r\n        </div>\r\n      </Menu.Item>\r\n      <Menu.Item>\r\n        <FormModalButton\r\n          buttonItem={<div>添加标签</div>}\r\n          title=\"添加标签\"\r\n          WrappedForm={WrappedTagsAddForm}\r\n          onSubmit={(tags) => onTagsAdd(metadata['id'], tags)}\r\n        />\r\n      </Menu.Item>\r\n    </Menu>\r\n  );\r\n  \r\n  return (\r\n    <Dropdown overlay={menu} trigger={['contextMenu']}>\r\n      <Card\r\n        hoverable\r\n        style={{ width: 240 }}\r\n        cover={\r\n          <img\r\n            src={`${BACKEND_PREFIX}/api/images/?id=${metadata['id']}`}\r\n            alt={`img-${metadata['id']}`}\r\n          />\r\n        }\r\n      >\r\n        <Meta description={<TagGroup tags={metadata['tags']} onTagDelete={(tag) => onTagDelete(metadata['id'], tag)} />}/>\r\n      </Card>\r\n    </Dropdown>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nimport ImageBox from './ImageBox.jsx';\r\n\r\n\r\n/**\r\n * props:\r\n *   imageMetaDatas [Array[Object]]: {\r\n *     \"id\": [Number],\r\n *     \"img_type\": [String],\r\n *     \"tags\": [Array[String]],\r\n *     \"create_at\": [String],\r\n *   }\r\n *   onImageDelete [callback]\r\n *   onTagsAdd [callback]\r\n *   onTagDelete [callback]\r\n */\r\nexport default function ImageWall({\r\n  imageMetaDatas,\r\n  onImageDelete,\r\n  onTagsAdd,\r\n  onTagDelete,\r\n}) {\r\n  return (\r\n    <div\r\n      style={{\r\n        display: 'flex',\r\n        flexWrap: 'wrap',\r\n      }}\r\n    >\r\n      {imageMetaDatas.map((m) => {\r\n        return (\r\n          <ImageBox\r\n            key={m['id']}\r\n            metadata={m}\r\n            onImageDelete={onImageDelete}\r\n            onTagsAdd={onTagsAdd}\r\n            onTagDelete={onTagDelete}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","/**get with cookie\r\n * \r\n * Params:\r\n *   url [String]\r\n *   params [Object]\r\n * Return:\r\n *   [Promise]: return [Response]\r\n */\r\nfunction get(url, params={}) {\r\n  const urlO = new URL(url);\r\n\r\n  for (const [k, v] of Object.entries(params)) {\r\n    urlO.searchParams.append(k, v);\r\n  }\r\n  console.log('get: %o', { urlO });\r\n  return fetch(urlO.href, {\r\n    mode: 'cors',\r\n    credentials: 'include',\r\n  });\r\n}\r\n\r\n\r\n/**JSON post with cookie\r\n * \r\n * Params:\r\n *   url [String]\r\n *   body [Object]:\r\n * Return:\r\n *   [Promise]: return [Response]\r\n */\r\nfunction post(url, body={}) {\r\n  console.log('post: %o', { url, body });\r\n  return fetch(url, {\r\n    method: 'POST',\r\n    body: JSON.stringify(body),\r\n    headers: new Headers({\r\n      'Content-Type': 'application/json'\r\n    }),\r\n    mode: 'cors',\r\n    credentials: 'include',\r\n  });\r\n}\r\n\r\n\r\n/**Form post with cookie\r\n * \r\n * Params:\r\n *   url [String]\r\n *   body [Object]:\r\n * Return:\r\n *   [Promise]: return [Response]\r\n */\r\nfunction postForm(url, body={}) {\r\n  const formData = new FormData();\r\n  for (const [k, v] of Object.entries(body)) {\r\n    formData.append(k, v);\r\n  }\r\n\r\n  console.log('postForm: %o', { url, formData });\r\n  return fetch(url, {\r\n    method: 'POST',\r\n    body: formData,\r\n    mode: 'cors',\r\n    credentials: 'include',\r\n  });\r\n}\r\n\r\n\r\nexport {\r\n  get,\r\n  post,\r\n  postForm,\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { message, Pagination } from 'antd';\r\n\r\nimport FunctionBar from './FunctionBar.jsx';\r\nimport ImageWall from './ImageWall.jsx';\r\n\r\nimport { get, postForm, post } from './utils';\r\nimport config from './config';\r\n\r\nconst { BACKEND_PREFIX } = config;\r\n\r\n\r\nexport default function App() {\r\n  const [ imageMetaDatas, setImageMetaDatas ] = useState([]);\r\n  const [ pagination, setPagination ] = useState({\r\n    current: 1,\r\n    pageSize: 20,\r\n    total: null,\r\n  });\r\n  const [ searchField, setSearchField ] = useState({\r\n    key: 'tag',\r\n    value: '',\r\n  });\r\n\r\n  const refresh = async () => {\r\n    console.log('App: handle refresh');\r\n    const params = {\r\n      page: pagination.current,\r\n      per_page: pagination.pageSize,\r\n      [searchField.key]: searchField.value,\r\n    }\r\n    const resp = await get(`${BACKEND_PREFIX}/api/images/`, params);\r\n    if (resp.status !== 200) {\r\n      message.error('网络异常，刷新失败');\r\n      console.error('Error: %o', { resp });\r\n      return ;\r\n    }\r\n\r\n    const respJSON = await resp.json();\r\n    console.log('App: receive resp: %o', { respJSON });\r\n    setImageMetaDatas(respJSON.data);\r\n    setPagination({\r\n      ...pagination,\r\n      current: respJSON['pagination']['page'],\r\n      pageSize: respJSON['pagination']['per_page'],\r\n      total: respJSON['pagination']['total'],\r\n    });\r\n    return ;\r\n  }\r\n\r\n  useEffect(() => {\r\n    refresh();\r\n  }, [pagination.current, pagination.pageSize, searchField])\r\n\r\n  const handleImageAdd = async (values) => {\r\n    console.log('App handleImageAdd: %o', { values });\r\n    const image = values['image'];\r\n    const imageType = image.type.split('/')[1];\r\n    const body = {\r\n      image: image,\r\n      metadata: JSON.stringify({\r\n        img_type: imageType,\r\n        tags: values['tags'],\r\n      })\r\n    }\r\n    console.log('App post body: %o', body);\r\n    const resp = await postForm(`${BACKEND_PREFIX}/api/images/add`, body);\r\n    if (resp.status !== 200) {\r\n      message.error('网络异常，添加图片失败');\r\n      console.error('Error: %o', { resp });\r\n      return ;\r\n    }\r\n\r\n    message.success('添加图片成功');\r\n    console.log('Success: %o', { resp });\r\n    refresh();\r\n    return ;\r\n  }\r\n\r\n  const handleImageDelete = async (id) => {\r\n    console.log('App handleImageDelete: %o', { id });\r\n    const resp = await get(`${BACKEND_PREFIX}/api/images/delete`, { id });\r\n    if (resp.status !== 200) {\r\n      message.error('网络异常，删除图片失败');\r\n      console.error('Error: %o', { resp });\r\n      return ;\r\n    }\r\n\r\n    message.success('删除图片成功');\r\n    console.log('Success: %o', { resp });\r\n    refresh();\r\n    return ;\r\n  }\r\n\r\n  const handleTagsAdd = async (imageId, tags) => {\r\n    console.log('App handleTagsAdd: %o', { imageId, tags });\r\n    const body = {\r\n      image_id: imageId,\r\n      tags,\r\n    }\r\n    console.log('App POST body: %o', body)\r\n    const resp = await post(`${BACKEND_PREFIX}/api/tags/add`, body);\r\n    if (resp.status !== 200) {\r\n      message.error('网络异常，添加标签失败');\r\n      console.error('Error: %o', { resp });\r\n      return ;\r\n    }\r\n\r\n    message.success('添加标签成功');\r\n    console.log('Success: %o', { resp });\r\n    refresh();\r\n    return ;\r\n  }\r\n\r\n  const handleTagDelete = async (imageId, tag) => {\r\n    console.log('App handleTagDelete: %o', { imageId, tag });\r\n    const body = {\r\n      image_id: imageId,\r\n      tag,\r\n    }\r\n    console.log('App POST body: %o', body)\r\n    const resp = await post(`${BACKEND_PREFIX}/api/tags/delete`, body);\r\n    if (resp.status !== 200) {\r\n      message.error('网络异常，删除标签失败');\r\n      console.error('Error: %o', { resp });\r\n      return ;\r\n    }\r\n\r\n    message.success('删除标签成功');\r\n    console.log('Success: %o', { resp });\r\n    refresh();\r\n    return ;\r\n  }\r\n  \r\n  return (\r\n    <div>\r\n      <FunctionBar\r\n        searchField={searchField}\r\n        onImageAdd={handleImageAdd}\r\n        onSearch={(key, value) => setSearchField({ key, value })}\r\n      />\r\n      <ImageWall\r\n        imageMetaDatas={imageMetaDatas}\r\n        onImageDelete={handleImageDelete}\r\n        onTagsAdd={handleTagsAdd}\r\n        onTagDelete={handleTagDelete}\r\n      />\r\n      <Pagination\r\n        {...pagination}\r\n        showSizeChanger\r\n        pageSizeOptions={['20', '50', '100', '200']}\r\n        onChange={(page, pageSize) => setPagination({\r\n          ...pagination,\r\n          current: page,\r\n          pageSize,\r\n        })}\r\n        onShowSizeChange={(current, size) => setPagination({\r\n          ...pagination,\r\n          current,\r\n          pageSize: size,\r\n        })}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App.jsx';\nimport * as serviceWorker from './serviceWorker';\n\nimport './index.css';\n\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}